INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 14195
INFO:root:  Num Turns = 56565
INFO:root:  Num Dialogs = 8421
INFO:root:  Num Epochs = 40
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 70975
INFO:root:Input examples:
INFO:root:<sos_u>  i need a train for sunday please. i prefer 1 that arrives by 20:15 <eos_u> <sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  choice [request]  destination <eos_a> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r> <sos_u>  i am heading to birmingham new street. <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, that would be fine. i 'll need the price, trainid, and departure time, please? <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  price leave departure <eos_a> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r> <sos_u>  i would also like to find a nice concerthall in the middle of town. <eos_u> <sos_b> [attraction]  type concert hall area centre [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  the [value_type]  in the [value_area]  is [value_name]  located at [value_address] . <eos_r>
INFO:root:Train epoch time: 13.62 min, epoch loss: 109632.1603
INFO:root:Train epoch time: 13.85 min, epoch loss: 24594.3179
INFO:root:Train epoch time: 13.85 min, epoch loss: 18141.2182
INFO:root:Train epoch time: 13.82 min, epoch loss: 16047.4781
INFO:root:Inference time:3.544 min
INFO:root:validation [CTR] 47.90  36.07  14.29  56.28  0.318
INFO:root:validation 39.68  29.46  14.29  48.86  0.318
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.23 min, epoch loss: 14963.7969
INFO:root:Inference time:3.824 min
INFO:root:validation [CTR] 74.45  60.82  16.56  84.20  0.348
INFO:root:validation 61.72  49.90  16.56  72.37  0.348
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.21 min, epoch loss: 14279.8431
INFO:root:Inference time:3.645 min
INFO:root:validation [CTR] 67.23  58.82  15.74  78.76  0.394
INFO:root:validation 62.93  54.81  15.74  74.61  0.394
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.19 min, epoch loss: 13766.7741
INFO:root:Inference time:3.794 min
INFO:root:validation [CTR] 78.46  71.04  16.80  91.54  0.421
INFO:root:validation 75.75  68.44  16.80  88.89  0.421
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.36 min, epoch loss: 13360.8718
INFO:root:Inference time:3.629 min
INFO:root:validation [CTR] 78.46  67.33  14.74  87.64  0.416
INFO:root:validation 73.35  62.63  14.74  82.73  0.416
INFO:root:Train epoch time: 13.15 min, epoch loss: 12977.9256
INFO:root:Inference time:3.821 min
INFO:root:validation [CTR] 70.04  64.23  17.12  84.26  0.451
INFO:root:validation 67.94  62.12  17.12  82.15  0.451
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.13 min, epoch loss: 12604.8945
INFO:root:Inference time:3.718 min
INFO:root:validation [CTR] 66.83  59.82  16.37  79.70  0.466
INFO:root:validation 65.73  58.92  16.37  78.70  0.466
INFO:root:early stop count:3
INFO:root:Train epoch time: 13.12 min, epoch loss: 12299.2934
INFO:root:Inference time:3.809 min
INFO:root:validation [CTR] 79.66  72.24  17.93  93.88  0.459
INFO:root:validation 76.75  69.04  17.93  90.82  0.459
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.13 min, epoch loss: 12025.8124
INFO:root:Inference time:3.793 min
INFO:root:validation [CTR] 79.96  72.24  16.53  92.63  0.479
INFO:root:validation 78.36  70.84  16.53  91.13  0.479
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.13 min, epoch loss: 11779.3676
INFO:root:Inference time:3.670 min
INFO:root:validation [CTR] 87.07  78.96  16.97  99.99  0.481
INFO:root:validation 84.57  77.05  16.97  97.78  0.481
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.29 min, epoch loss: 11551.2326
INFO:root:Inference time:3.726 min
INFO:root:validation [CTR] 86.67  78.86  17.58  100.35  0.458
INFO:root:validation 82.77  75.35  17.58  96.64  0.458
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.22 min, epoch loss: 11329.7821
INFO:root:Inference time:3.762 min
INFO:root:validation [CTR] 89.88  81.86  17.72  103.59  0.481
INFO:root:validation 88.08  79.96  17.72  101.74  0.481
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.71 min, epoch loss: 11133.0948
INFO:root:Inference time:3.790 min
INFO:root:validation [CTR] 88.08  80.06  17.19  101.26  0.485
INFO:root:validation 87.47  79.56  17.19  100.71  0.485
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.14 min, epoch loss: 10941.6159
INFO:root:Inference time:3.807 min
INFO:root:validation [CTR] 87.88  80.16  17.51  101.53  0.489
INFO:root:validation 86.27  78.56  17.51  99.92  0.489
INFO:root:early stop count:3
INFO:root:Train epoch time: 13.53 min, epoch loss: 10764.3624
INFO:root:Inference time:3.762 min
INFO:root:validation [CTR] 86.07  78.46  17.33  99.60  0.478
INFO:root:validation 83.87  76.45  17.33  97.50  0.478
INFO:root:early stop count:2
INFO:root:Train epoch time: 13.11 min, epoch loss: 10587.5022
INFO:root:Inference time:3.702 min
INFO:root:validation [CTR] 91.68  83.77  16.69  104.41  0.479
INFO:root:validation 88.98  81.16  16.69  101.76  0.479
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.09 min, epoch loss: 10430.1927
INFO:root:Inference time:3.730 min
INFO:root:validation [CTR] 90.48  82.57  17.23  103.76  0.474
INFO:root:validation 88.38  80.76  17.23  101.80  0.474
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.87 min, epoch loss: 10267.9614
INFO:root:Inference time:4.318 min
INFO:root:validation [CTR] 90.68  83.67  17.19  104.37  0.481
INFO:root:validation 87.68  80.76  17.19  101.41  0.481
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.90 min, epoch loss: 10125.1780
INFO:root:Inference time:4.285 min
INFO:root:validation [CTR] 89.68  83.07  17.64  104.01  0.472
INFO:root:validation 87.47  80.96  17.64  101.86  0.472
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 14.00 min, epoch loss: 9984.7347
INFO:root:Inference time:4.248 min
INFO:root:validation [CTR] 86.07  80.26  17.48  100.64  0.476
INFO:root:validation 84.77  78.96  17.48  99.34  0.476
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.93 min, epoch loss: 9852.4558
INFO:root:Inference time:4.376 min
INFO:root:validation [CTR] 90.88  82.77  17.31  104.14  0.483
INFO:root:validation 89.68  81.66  17.31  102.98  0.483
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Train epoch time: 13.89 min, epoch loss: 9726.4424
INFO:root:Inference time:4.183 min
INFO:root:validation [CTR] 85.47  78.16  16.59  98.40  0.476
INFO:root:validation 83.97  77.15  16.59  97.15  0.476
INFO:root:early stop count:4
INFO:root:Train epoch time: 13.89 min, epoch loss: 9607.3668
INFO:root:Inference time:4.243 min
INFO:root:validation [CTR] 88.98  81.46  16.81  102.04  0.468
INFO:root:validation 87.98  80.26  16.81  100.93  0.468
INFO:root:early stop count:3
INFO:root:Train epoch time: 13.91 min, epoch loss: 9489.6122
INFO:root:Inference time:4.229 min
INFO:root:validation [CTR] 86.47  80.06  17.03  100.30  0.485
INFO:root:validation 84.37  78.16  17.03  98.29  0.485
INFO:root:early stop count:2
INFO:root:Train epoch time: 14.08 min, epoch loss: 9382.5379
INFO:root:Inference time:4.451 min
INFO:root:validation [CTR] 88.88  79.86  16.62  100.99  0.479
INFO:root:validation 86.27  77.35  16.62  98.43  0.479
INFO:root:early stop count:1
INFO:root:Train epoch time: 14.06 min, epoch loss: 9283.9445
INFO:root:Inference time:4.285 min
INFO:root:validation [CTR] 89.18  81.86  16.55  102.07  0.469
INFO:root:validation 86.17  78.76  16.55  99.01  0.469
INFO:root:early stop count:0
INFO:root:Train epoch time: 13.93 min, epoch loss: 9181.3568
INFO:root:Inference time:4.274 min
INFO:root:validation [CTR] 90.48  82.36  16.62  103.04  0.477
INFO:root:validation 87.27  79.06  16.62  99.78  0.477
INFO:root:early stop count:-1
INFO:root:Train epoch time: 13.92 min, epoch loss: 9094.4653
INFO:root:Inference time:4.292 min
INFO:root:validation [CTR] 89.28  81.06  16.65  101.82  0.470
INFO:root:validation 86.87  78.96  16.65  99.57  0.470
INFO:root:early stop count:-2
INFO:root:Train epoch time: 13.94 min, epoch loss: 9011.8685
INFO:root:Inference time:4.169 min
INFO:root:validation [CTR] 87.68  80.06  16.53  100.40  0.481
INFO:root:validation 85.17  77.76  16.53  98.00  0.481
INFO:root:early stop count:-3
INFO:root:Train epoch time: 13.96 min, epoch loss: 8936.1859
INFO:root:Inference time:4.205 min
INFO:root:validation [CTR] 89.98  83.07  16.61  103.13  0.480
INFO:root:validation 86.47  79.86  16.61  99.77  0.480
INFO:root:early stop count:-4
INFO:root:Train epoch time: 13.98 min, epoch loss: 8868.4264
INFO:root:Inference time:4.173 min
INFO:root:validation [CTR] 90.38  83.17  16.52  103.29  0.479
INFO:root:validation 87.47  80.06  16.52  100.29  0.479
INFO:root:early stop count:-5
INFO:root:Train epoch time: 13.96 min, epoch loss: 8794.1065
INFO:root:Inference time:4.174 min
INFO:root:validation [CTR] 90.68  82.97  16.71  103.53  0.475
INFO:root:validation 87.78  80.36  16.71  100.77  0.475
INFO:root:early stop count:-6
INFO:root:Train epoch time: 13.66 min, epoch loss: 8737.8749
INFO:root:Inference time:4.389 min
INFO:root:validation [CTR] 90.08  82.26  16.56  102.73  0.473
INFO:root:validation 86.77  79.06  16.56  99.47  0.473
INFO:root:early stop count:-7
INFO:root:Train epoch time: 13.69 min, epoch loss: 8680.6623
INFO:root:Inference time:3.930 min
INFO:root:validation [CTR] 90.08  82.97  16.88  103.41  0.471
INFO:root:validation 87.07  80.16  16.88  100.50  0.471
INFO:root:early stop count:-8
INFO:root:Train epoch time: 13.60 min, epoch loss: 8637.7904
INFO:root:Inference time:3.914 min
INFO:root:validation [CTR] 90.38  82.97  16.76  103.44  0.472
INFO:root:validation 87.27  80.06  16.76  100.43  0.472
INFO:root:early stop count:-9
