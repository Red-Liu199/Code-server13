INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/encoded_us_data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running pretraining *****
INFO:root:  Num Dialogs = 8434
INFO:root:  Num Epochs = 60
INFO:root:  Batch size  = 2
INFO:root:warmup epochs:7
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  leave 13:15 destination ely day thursday departure cambridge [fail_info] [book] [invalid]  no people 8 [fail_book] [restaurant] [inform]  food indian pricerange cheap area centre [fail_info]  food english pricerange cheap area centre [book]  people 8 day monday [invalid]  no time 16:30 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  price cheap <eos_ua> <sos_u>  i need a place to eat that is cheap. <eos_u> <sos_r>  i have [value_choice] [value_price]  restaurant -s in different area -s of town. do you have a location preference? <eos_r> <sos_ua> [restaurant] [inform]  area centre <eos_ua> <sos_u>  yes. i want the center area. <eos_u> <sos_r>  i can recommend [value_name]  that serves [value_food]  food <eos_r> <sos_ua> [restaurant] [inform]  food english <eos_ua> <sos_u>  do you have any restaurant -s that serve english food? <eos_u> <sos_r>  i am showing nothing for [value_food]  food in the [value_area]  area. would you like to try something else? <eos_r> <sos_ua> [restaurant] [inform]  food indian time 16:30 day monday people 8 <eos_ua> <sos_u>  how about some awesome indian food. i need a table for 8 on 16:30 monday <eos_u> <sos_r>  i booked you at [value_name] . the table will be reserved for 15 minutes. reference number is : [value_reference] . is there anything else i can help you with? <eos_r> <sos_ua> [train] [inform]  day thursday departure cambridge <eos_ua> <sos_u>  thanks for your help. in addition, i am looking for a thursday train departing cambridge, please. <eos_u> <sos_r>  there are [value_choice]  trains leaving [value_departure]  on [value_day] . where is your destination? <eos_r> <sos_ua> [train] [inform]  destination ely leave 13:15 <eos_ua> <sos_u>  i am looking to travel to ely departing after 13:15 if possible. <eos_u> <sos_r>  the [value_id]  leaves at [value_leave]  on [value_day] . would you like me to book you? <eos_r> <sos_ua> [train] [inform]  people 8 <eos_ua> <sos_u>  yes, please book 8 tickets and provide me with a reference number <eos_u> <sos_r>  okay i have booked that for you and the reference number is [value_reference] . is there anything else i can do for you? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  great, thanks. that is all for now! <eos_u> <sos_r>  ok. i hope you have a great day! <eos_r>
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  destination cambridge day friday arrive 13:00 departure ely [fail_info] [book] [invalid]  no people 2 [fail_book] [restaurant] [inform]  name kohinoor [fail_info] [book]  people 2 day thursday [invalid]  no time 16:45 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  none none <eos_ua> <sos_u>  i need to find some information in a particular restaurant. are you able to look up a specific place? <eos_u> <sos_r>  absolutely. what is the name of the restaraunt you are interested in? <eos_r> <sos_ua> [restaurant] [inform]  name kohinoor time 16:45 day thursday people 2 <eos_ua> <sos_u>  kohinoor. i want to book a table for 2 people at 16:45 on thursday <eos_u> <sos_r>  sure. booking was successful. the table will be reserved for 15 minutes. reference number is : [value_reference] . can i help with anything else today? <eos_r> <sos_ua> [train] [inform]  day thursday <eos_ua> <sos_u>  i also need a thursday train. <eos_u> <sos_r>  what location will you depart from and where are you headed? <eos_r> <sos_ua> [train] [inform]  destination cambridge arrive 13:00 departure ely people 2 <eos_ua> <sos_u>  depart from ely and would like to arrive by 13:00 in cambridge. i need to book it for 2 people i also need a reference number. thanks <eos_u> <sos_r>  sure thing, it is booked and your reference number is [value_reference] . do you need more help? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  nope, i am all finished for today. thanks so much, goodbye now! <eos_u> <sos_r>  you are very welcome, bye! <eos_r>
INFO:root:Epoch:0, Train epoch time: 5.54 min, loss: 12.96175973473084
INFO:root:model evaluation loss:3.7067421669997866
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:1, Train epoch time: 5.55 min, loss: 3.2437015688979463
INFO:root:model evaluation loss:2.3059178491433463
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:2, Train epoch time: 5.77 min, loss: 2.0939214601865244
INFO:root:model evaluation loss:1.6567700365706095
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:3, Train epoch time: 5.79 min, loss: 1.6436508417723583
INFO:root:model evaluation loss:1.4200311864888857
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:4, Train epoch time: 5.55 min, loss: 1.4279139952519295
INFO:root:model evaluation loss:1.2984165432197707
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:5, Train epoch time: 5.72 min, loss: 1.3052663309601285
INFO:root:model evaluation loss:1.21948751144939
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:6, Train epoch time: 5.53 min, loss: 1.2212932623275716
INFO:root:model evaluation loss:1.1635943665390922
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:7, Train epoch time: 5.52 min, loss: 1.1613105402549522
INFO:root:model evaluation loss:1.1295754146717845
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:8, Train epoch time: 5.54 min, loss: 1.1125174038603682
INFO:root:model evaluation loss:1.1007116050237702
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:9, Train epoch time: 5.77 min, loss: 1.0761610564457957
INFO:root:model evaluation loss:1.0815816252004533
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:10, Train epoch time: 5.77 min, loss: 1.0473694386969372
INFO:root:model evaluation loss:1.0691082511865904
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:11, Train epoch time: 5.77 min, loss: 1.0227964587711191
INFO:root:model evaluation loss:1.060031794721172
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:12, Train epoch time: 5.78 min, loss: 1.001980987583001
INFO:root:model evaluation loss:1.0499913872234405
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:13, Train epoch time: 5.76 min, loss: 0.9840809261213279
INFO:root:model evaluation loss:1.0467699193765247
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:14, Train epoch time: 5.74 min, loss: 0.9680205994256028
INFO:root:model evaluation loss:1.0397378336342553
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:15, Train epoch time: 5.52 min, loss: 0.9529998591501225
INFO:root:model evaluation loss:1.038652938982797
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:16, Train epoch time: 5.52 min, loss: 0.9395834109372418
INFO:root:model evaluation loss:1.0388020858878182
INFO:root:early stop count:4
INFO:root:Epoch:17, Train epoch time: 5.52 min, loss: 0.9264004723220625
INFO:root:model evaluation loss:1.033740907197907
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:18, Train epoch time: 5.52 min, loss: 0.9144874136200096
INFO:root:model evaluation loss:1.0338773473151146
INFO:root:early stop count:4
INFO:root:Epoch:19, Train epoch time: 5.52 min, loss: 0.9035419092593625
INFO:root:model evaluation loss:1.0348992359543603
INFO:root:early stop count:3
INFO:root:Epoch:20, Train epoch time: 5.65 min, loss: 0.8931284881509419
INFO:root:model evaluation loss:1.0304605470053734
INFO:root:Saving model checkpoint to ./experiments_21/all_US_722_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:21, Train epoch time: 5.52 min, loss: 0.8830388796360616
INFO:root:model evaluation loss:1.0335295312697925
INFO:root:early stop count:4
INFO:root:Epoch:22, Train epoch time: 5.52 min, loss: 0.8735685804244405
INFO:root:model evaluation loss:1.0362420186163888
INFO:root:early stop count:3
INFO:root:Epoch:23, Train epoch time: 5.58 min, loss: 0.8637294666598518
INFO:root:model evaluation loss:1.0353964651151308
INFO:root:early stop count:2
INFO:root:Epoch:24, Train epoch time: 5.52 min, loss: 0.8558054484982144
INFO:root:model evaluation loss:1.0405207929157076
INFO:root:early stop count:1
INFO:root:Epoch:25, Train epoch time: 5.51 min, loss: 0.8468555248018459
INFO:root:model evaluation loss:1.0369986378484302
INFO:root:early stop count:0
INFO:root:Epoch:26, Train epoch time: 5.51 min, loss: 0.8383184227196029
INFO:root:model evaluation loss:1.0444830794419562
INFO:root:early stop count:-1
INFO:root:Epoch:27, Train epoch time: 5.51 min, loss: 0.8306387713772174
INFO:root:model evaluation loss:1.0449177165116583
INFO:root:early stop count:-2
INFO:root:Epoch:28, Train epoch time: 5.69 min, loss: 0.823708907696213
INFO:root:model evaluation loss:1.041368433643901
INFO:root:early stop count:-3
INFO:root:Epoch:29, Train epoch time: 5.52 min, loss: 0.8167502277826437
INFO:root:model evaluation loss:1.0473339905341466
INFO:root:early stop count:-4
INFO:root:Epoch:30, Train epoch time: 5.53 min, loss: 0.809798408609094
INFO:root:model evaluation loss:1.0510313849127482
INFO:root:early stop count:-5
INFO:root:Epoch:31, Train epoch time: 5.52 min, loss: 0.8024535337237594
INFO:root:model evaluation loss:1.0571813361039237
INFO:root:early stop count:-6
INFO:root:Epoch:32, Train epoch time: 5.53 min, loss: 0.7959980332369084
INFO:root:model evaluation loss:1.0563071197460567
INFO:root:early stop count:-7
INFO:root:Epoch:33, Train epoch time: 5.53 min, loss: 0.7901756581277942
INFO:root:model evaluation loss:1.0568984561259784
INFO:root:early stop count:-8
INFO:root:Epoch:34, Train epoch time: 5.53 min, loss: 0.7839743425432234
INFO:root:model evaluation loss:1.0591573606407831
INFO:root:early stop count:-9
INFO:root:Epoch:35, Train epoch time: 5.52 min, loss: 0.7787691703694773
INFO:root:model evaluation loss:1.0575790496336088
INFO:root:early stop count:-10
INFO:root:Epoch:36, Train epoch time: 5.74 min, loss: 0.7732713473585046
INFO:root:model evaluation loss:1.0602419835234445
INFO:root:early stop count:-11
INFO:root:Epoch:37, Train epoch time: 5.61 min, loss: 0.7673519756034985
INFO:root:model evaluation loss:1.067797957076913
INFO:root:early stop count:-12
INFO:root:Epoch:38, Train epoch time: 5.53 min, loss: 0.7630690649526629
INFO:root:model evaluation loss:1.0669565311973057
INFO:root:early stop count:-13
INFO:root:Epoch:39, Train epoch time: 5.53 min, loss: 0.7577550651927271
INFO:root:model evaluation loss:1.0668498478711597
INFO:root:early stop count:-14
INFO:root:Epoch:40, Train epoch time: 5.54 min, loss: 0.7531339283776215
INFO:root:model evaluation loss:1.0694114680564593
INFO:root:early stop count:-15
INFO:root:Epoch:41, Train epoch time: 5.54 min, loss: 0.7487719530707352
INFO:root:model evaluation loss:1.0719499606934806
INFO:root:early stop count:-16
INFO:root:Epoch:42, Train epoch time: 5.54 min, loss: 0.7443527410882709
INFO:root:model evaluation loss:1.0751519646672976
INFO:root:early stop count:-17
INFO:root:Epoch:43, Train epoch time: 5.54 min, loss: 0.740598050133985
INFO:root:model evaluation loss:1.0852252753481033
INFO:root:early stop count:-18
INFO:root:Epoch:44, Train epoch time: 5.54 min, loss: 0.7369465285821102
INFO:root:model evaluation loss:1.0814402641521559
INFO:root:early stop count:-19
INFO:root:Epoch:45, Train epoch time: 5.54 min, loss: 0.7333777142970637
INFO:root:model evaluation loss:1.0853374991861602
INFO:root:early stop count:-20
INFO:root:Epoch:46, Train epoch time: 5.54 min, loss: 0.7295762372415779
INFO:root:model evaluation loss:1.0860324293848067
INFO:root:early stop count:-21
INFO:root:Epoch:47, Train epoch time: 5.54 min, loss: 0.7264693823890999
INFO:root:model evaluation loss:1.0895022689586593
INFO:root:early stop count:-22
INFO:root:Epoch:48, Train epoch time: 5.54 min, loss: 0.7234211502447335
INFO:root:model evaluation loss:1.0908865662557738
INFO:root:early stop count:-23
INFO:root:Epoch:49, Train epoch time: 5.54 min, loss: 0.720148600093352
INFO:root:model evaluation loss:1.097374536333576
INFO:root:early stop count:-24
INFO:root:Epoch:50, Train epoch time: 5.54 min, loss: 0.7175837877976934
INFO:root:model evaluation loss:1.0944901325163388
INFO:root:early stop count:-25
INFO:root:Epoch:51, Train epoch time: 5.54 min, loss: 0.7147698061700731
INFO:root:model evaluation loss:1.0947239031157796
INFO:root:early stop count:-26
INFO:root:Epoch:52, Train epoch time: 5.54 min, loss: 0.713492905808587
INFO:root:model evaluation loss:1.0958159211136045
INFO:root:early stop count:-27
INFO:root:Epoch:53, Train epoch time: 5.54 min, loss: 0.7102992133978678
INFO:root:model evaluation loss:1.0995634912498413
INFO:root:early stop count:-28
INFO:root:Epoch:54, Train epoch time: 5.54 min, loss: 0.7085208984708045
INFO:root:model evaluation loss:1.0988238308401335
INFO:root:early stop count:-29
INFO:root:Epoch:55, Train epoch time: 5.53 min, loss: 0.7072267560637501
INFO:root:model evaluation loss:1.0970981474670152
INFO:root:early stop count:-30
INFO:root:Epoch:56, Train epoch time: 5.52 min, loss: 0.7056464860732939
INFO:root:model evaluation loss:1.1006049089252004
INFO:root:early stop count:-31
INFO:root:Epoch:57, Train epoch time: 5.69 min, loss: 0.704148762364791
INFO:root:model evaluation loss:1.1012052961048626
INFO:root:early stop count:-32
INFO:root:Epoch:58, Train epoch time: 5.53 min, loss: 0.7030813041871116
INFO:root:model evaluation loss:1.1016727623248856
INFO:root:early stop count:-33
INFO:root:Epoch:59, Train epoch time: 5.53 min, loss: 0.7015196877966207
INFO:root:model evaluation loss:1.1020125661577498
INFO:root:early stop count:-34
