INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data_fix.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 14195
INFO:root:  Num Turns = 56565
INFO:root:  Num Dialogs = 8421
INFO:root:  Num Epochs = 50
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 88718
INFO:root:Input examples:
INFO:root:<sos_u>  i need a train for sunday please. i prefer 1 that arrives by 20:15 <eos_u> <sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  choice [request]  destination <eos_a> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r> <sos_u>  i am heading to birmingham new street. <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, that would be fine. i 'll need the price, trainid, and departure time, please? <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  price leave departure <eos_a> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r> <sos_u>  i would also like to find a nice concerthall in the middle of town. <eos_u> <sos_b> [attraction]  type concert hall area centre [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  the [value_type]  in the [value_area]  is [value_name]  located at [value_address] . <eos_r>
INFO:root:Epoch:0, Train epoch time: 12.99 min, epoch loss: 118554.1795
INFO:root:Epoch:1, Train epoch time: 13.55 min, epoch loss: 26546.7623
INFO:root:Epoch:2, Train epoch time: 13.15 min, epoch loss: 19177.0178
INFO:root:Epoch:3, Train epoch time: 13.80 min, epoch loss: 16756.1422
INFO:root:Epoch:4, Train epoch time: 13.62 min, epoch loss: 15529.9927
INFO:root:Epoch:5, Train epoch time: 14.04 min, epoch loss: 14771.2221
INFO:root:Epoch:6, Train epoch time: 13.49 min, epoch loss: 14227.7008
INFO:root:Inference time:3.488 min
INFO:root:validation [CTR] 73.75  64.73  16.09  85.33  0.512
INFO:root:validation 71.44  62.93  16.09  83.27  0.512
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:7, Train epoch time: 13.28 min, epoch loss: 13801.7584
INFO:root:Inference time:3.386 min
INFO:root:validation [CTR] 81.36  70.54  14.24  90.20  0.542
INFO:root:validation 79.36  68.84  14.24  88.34  0.542
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:8, Train epoch time: 12.80 min, epoch loss: 13447.0642
INFO:root:Inference time:3.504 min
INFO:root:validation [CTR] 71.64  64.43  16.98  85.02  0.526
INFO:root:validation 69.64  62.73  16.98  83.17  0.526
INFO:root:Epoch:9, Train epoch time: 13.35 min, epoch loss: 13137.4051
INFO:root:Inference time:3.497 min
INFO:root:validation [CTR] 65.73  57.11  16.18  77.60  0.551
INFO:root:validation 64.83  56.31  16.18  76.75  0.551
INFO:root:Epoch:10, Train epoch time: 12.76 min, epoch loss: 12825.9067
INFO:root:Inference time:3.624 min
INFO:root:validation [CTR] 74.65  66.63  17.92  88.56  0.562
INFO:root:validation 72.04  64.23  17.92  86.06  0.562
INFO:root:early stop count:4
INFO:root:Epoch:11, Train epoch time: 13.36 min, epoch loss: 12513.6677
INFO:root:Inference time:3.686 min
INFO:root:validation [CTR] 86.47  77.35  16.54  98.45  0.572
INFO:root:validation 84.27  75.25  16.54  96.30  0.572
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:12, Train epoch time: 13.43 min, epoch loss: 12236.6895
INFO:root:Inference time:3.641 min
INFO:root:validation [CTR] 89.08  81.16  17.34  102.46  0.597
INFO:root:validation 86.07  78.26  17.34  99.51  0.597
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:13, Train epoch time: 13.06 min, epoch loss: 11973.8050
INFO:root:Inference time:3.595 min
INFO:root:validation [CTR] 81.66  73.45  17.13  94.69  0.579
INFO:root:validation 79.66  71.64  17.13  92.78  0.579
INFO:root:early stop count:4
INFO:root:Epoch:14, Train epoch time: 13.31 min, epoch loss: 11736.5058
INFO:root:Inference time:3.629 min
INFO:root:validation [CTR] 88.98  81.96  17.43  102.90  0.591
INFO:root:validation 87.98  80.76  17.43  101.80  0.591
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:15, Train epoch time: 12.83 min, epoch loss: 11518.2561
INFO:root:Inference time:3.656 min
INFO:root:validation [CTR] 87.98  79.36  17.38  101.05  0.588
INFO:root:validation 86.57  77.96  17.38  99.65  0.588
INFO:root:early stop count:4
INFO:root:Epoch:16, Train epoch time: 13.02 min, epoch loss: 11306.4769
INFO:root:Inference time:3.684 min
INFO:root:validation [CTR] 86.57  78.56  17.63  100.19  0.587
INFO:root:validation 84.27  76.55  17.63  98.04  0.587
INFO:root:early stop count:3
INFO:root:Epoch:17, Train epoch time: 13.04 min, epoch loss: 11109.2595
INFO:root:Inference time:3.782 min
INFO:root:validation [CTR] 89.08  82.26  17.60  103.27  0.573
INFO:root:validation 86.47  79.96  17.60  100.81  0.573
INFO:root:early stop count:2
INFO:root:Epoch:18, Train epoch time: 13.33 min, epoch loss: 10918.8109
INFO:root:Inference time:3.645 min
INFO:root:validation [CTR] 90.88  82.06  16.98  103.45  0.588
INFO:root:validation 88.58  80.06  16.98  101.30  0.588
INFO:root:early stop count:1
INFO:root:Epoch:19, Train epoch time: 13.11 min, epoch loss: 10742.6555
INFO:root:Inference time:3.677 min
INFO:root:validation [CTR] 90.48  82.67  17.01  103.58  0.583
INFO:root:validation 88.58  80.86  17.01  101.73  0.583
INFO:root:early stop count:0
INFO:root:Epoch:20, Train epoch time: 12.90 min, epoch loss: 10567.2783
INFO:root:Inference time:3.671 min
INFO:root:validation [CTR] 92.18  83.77  16.60  104.58  0.574
INFO:root:validation 89.98  81.86  16.60  102.53  0.574
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:21, Train epoch time: 13.19 min, epoch loss: 10401.5163
INFO:root:Inference time:3.728 min
INFO:root:validation [CTR] 91.68  84.37  17.57  105.60  0.585
INFO:root:validation 90.28  82.97  17.57  104.19  0.585
INFO:root:Saving model checkpoint to ./experiments_21/all_turn-level-DS_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:22, Train epoch time: 13.31 min, epoch loss: 10242.2183
INFO:root:Inference time:3.744 min
INFO:root:validation [CTR] 90.48  82.26  17.19  103.56  0.578
INFO:root:validation 88.08  79.96  17.19  101.20  0.578
INFO:root:early stop count:4
INFO:root:Epoch:23, Train epoch time: 13.28 min, epoch loss: 10092.8997
INFO:root:Inference time:3.631 min
INFO:root:validation [CTR] 91.68  82.36  17.30  104.32  0.585
INFO:root:validation 89.48  80.26  17.30  102.17  0.585
INFO:root:early stop count:3
INFO:root:Epoch:24, Train epoch time: 13.23 min, epoch loss: 9946.7990
INFO:root:Inference time:3.911 min
INFO:root:validation [CTR] 86.57  78.06  16.31  98.63  0.578
INFO:root:validation 84.97  76.55  16.31  97.08  0.578
INFO:root:early stop count:2
INFO:root:Epoch:25, Train epoch time: 13.13 min, epoch loss: 9807.2120
INFO:root:Inference time:3.596 min
INFO:root:validation [CTR] 91.98  83.57  16.78  104.56  0.579
INFO:root:validation 88.78  80.56  16.78  101.45  0.579
INFO:root:early stop count:1
INFO:root:Epoch:26, Train epoch time: 12.81 min, epoch loss: 9671.9916
INFO:root:Inference time:3.612 min
INFO:root:validation [CTR] 87.88  79.96  16.91  100.83  0.576
INFO:root:validation 83.77  76.05  16.91  96.82  0.576
INFO:root:early stop count:0
INFO:root:Epoch:27, Train epoch time: 12.97 min, epoch loss: 9544.2138
INFO:root:Inference time:3.504 min
INFO:root:validation [CTR] 88.48  79.76  16.41  100.53  0.578
INFO:root:validation 86.27  77.56  16.41  98.33  0.578
INFO:root:early stop count:-1
INFO:root:Epoch:28, Train epoch time: 23.47 min, epoch loss: 9423.8881
INFO:root:Inference time:4.888 min
INFO:root:validation [CTR] 89.58  82.06  16.60  102.42  0.582
INFO:root:validation 87.88  80.46  16.60  100.77  0.582
INFO:root:early stop count:-2
INFO:root:Epoch:29, Train epoch time: 15.19 min, epoch loss: 9302.8496
INFO:root:Inference time:3.665 min
INFO:root:validation [CTR] 89.58  80.46  16.55  101.57  0.573
INFO:root:validation 86.97  77.86  16.55  98.97  0.573
INFO:root:early stop count:-3
INFO:root:Epoch:30, Train epoch time: 14.79 min, epoch loss: 9184.4746
INFO:root:Inference time:3.879 min
INFO:root:validation [CTR] 90.08  81.26  16.38  102.05  0.573
INFO:root:validation 87.07  78.66  16.38  99.25  0.573
INFO:root:early stop count:-4
INFO:root:Epoch:31, Train epoch time: 22.42 min, epoch loss: 9075.7288
INFO:root:Inference time:4.974 min
INFO:root:validation [CTR] 86.97  77.96  16.41  98.87  0.573
INFO:root:validation 84.77  75.75  16.41  96.67  0.573
INFO:root:early stop count:-5
INFO:root:Epoch:32, Train epoch time: 15.00 min, epoch loss: 8971.2784
INFO:root:Inference time:4.340 min
INFO:root:validation [CTR] 90.28  81.46  16.50  102.37  0.574
INFO:root:validation 88.28  79.16  16.50  100.22  0.574
INFO:root:early stop count:-6
INFO:root:Epoch:33, Train epoch time: 25.61 min, epoch loss: 8869.6504
INFO:root:Inference time:4.037 min
INFO:root:validation [CTR] 89.88  81.86  16.73  102.60  0.568
INFO:root:validation 86.87  78.86  16.73  99.60  0.568
INFO:root:early stop count:-7
INFO:root:Epoch:34, Train epoch time: 14.44 min, epoch loss: 8776.5005
INFO:root:Inference time:4.165 min
INFO:root:validation [CTR] 90.08  80.86  16.62  102.09  0.580
INFO:root:validation 88.28  79.26  16.62  100.39  0.580
INFO:root:early stop count:-8
INFO:root:Epoch:35, Train epoch time: 22.15 min, epoch loss: 8686.9606
INFO:root:Inference time:4.897 min
INFO:root:validation [CTR] 90.08  81.36  16.57  102.29  0.582
INFO:root:validation 87.98  79.26  16.57  100.19  0.582
INFO:root:early stop count:-9
INFO:root:Epoch:36, Train epoch time: 28.37 min, epoch loss: 8599.7090
INFO:root:Inference time:5.187 min
INFO:root:validation [CTR] 89.88  81.96  16.51  102.43  0.575
INFO:root:validation 86.67  79.16  16.51  99.43  0.575
INFO:root:early stop count:-10
INFO:root:Epoch:37, Train epoch time: 28.13 min, epoch loss: 8520.2440
INFO:root:Inference time:5.003 min
INFO:root:validation [CTR] 86.97  78.76  16.20  99.07  0.575
INFO:root:validation 84.67  76.45  16.20  96.76  0.575
INFO:root:early stop count:-11
INFO:root:Epoch:38, Train epoch time: 27.97 min, epoch loss: 8434.6533
INFO:root:Inference time:4.999 min
INFO:root:validation [CTR] 87.58  80.66  15.90  100.02  0.580
INFO:root:validation 85.37  78.46  15.90  97.82  0.580
INFO:root:early stop count:-12
INFO:root:Epoch:39, Train epoch time: 34.98 min, epoch loss: 8370.1007
INFO:root:Inference time:4.914 min
INFO:root:validation [CTR] 87.37  77.76  15.93  98.49  0.571
INFO:root:validation 85.27  75.55  15.93  96.34  0.571
INFO:root:early stop count:-13
INFO:root:Epoch:40, Train epoch time: 27.93 min, epoch loss: 8299.5194
INFO:root:Inference time:5.072 min
INFO:root:validation [CTR] 90.88  82.06  16.21  102.69  0.578
INFO:root:validation 87.88  79.36  16.21  99.83  0.578
INFO:root:early stop count:-14
INFO:root:Epoch:41, Train epoch time: 27.62 min, epoch loss: 8234.0460
INFO:root:Inference time:5.000 min
INFO:root:validation [CTR] 89.68  81.66  15.87  101.54  0.572
INFO:root:validation 86.77  78.96  15.87  98.73  0.572
INFO:root:early stop count:-15
INFO:root:Epoch:42, Train epoch time: 27.69 min, epoch loss: 8177.1051
INFO:root:Inference time:4.966 min
INFO:root:validation [CTR] 89.18  80.96  16.55  101.62  0.579
INFO:root:validation 86.47  78.26  16.55  98.92  0.579
INFO:root:early stop count:-16
INFO:root:Epoch:43, Train epoch time: 27.67 min, epoch loss: 8118.1661
INFO:root:Inference time:4.961 min
INFO:root:validation [CTR] 89.18  81.06  16.35  101.47  0.574
INFO:root:validation 86.77  78.76  16.35  99.12  0.574
INFO:root:early stop count:-17
INFO:root:Epoch:44, Train epoch time: 27.68 min, epoch loss: 8069.0302
INFO:root:Inference time:4.939 min
INFO:root:validation [CTR] 88.88  80.56  16.01  100.73  0.573
INFO:root:validation 87.07  78.76  16.01  98.92  0.573
INFO:root:early stop count:-18
INFO:root:Epoch:45, Train epoch time: 27.74 min, epoch loss: 8020.2442
INFO:root:Inference time:5.059 min
INFO:root:validation [CTR] 89.68  82.06  16.29  102.17  0.573
INFO:root:validation 87.07  79.36  16.29  99.51  0.573
INFO:root:early stop count:-19
INFO:root:Epoch:46, Train epoch time: 27.68 min, epoch loss: 7980.3090
INFO:root:Inference time:4.930 min
INFO:root:validation [CTR] 89.48  81.56  16.29  101.81  0.575
INFO:root:validation 86.37  78.66  16.29  98.80  0.575
INFO:root:early stop count:-20
INFO:root:Epoch:47, Train epoch time: 27.72 min, epoch loss: 7945.9181
INFO:root:Inference time:4.918 min
INFO:root:validation [CTR] 90.58  82.26  16.00  102.42  0.577
INFO:root:validation 87.98  79.56  16.00  99.77  0.577
INFO:root:early stop count:-21
INFO:root:Epoch:48, Train epoch time: 27.59 min, epoch loss: 7911.9025
INFO:root:Inference time:4.954 min
INFO:root:validation [CTR] 90.38  81.76  16.10  102.17  0.578
INFO:root:validation 87.88  79.16  16.10  99.61  0.578
INFO:root:early stop count:-22
INFO:root:Epoch:49, Train epoch time: 27.72 min, epoch loss: 7884.5592
INFO:root:Inference time:5.232 min
INFO:root:validation [CTR] 90.28  81.16  16.15  101.87  0.579
INFO:root:validation 87.37  78.16  16.15  98.91  0.579
INFO:root:early stop count:-23
