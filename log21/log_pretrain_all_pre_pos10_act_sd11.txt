INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Posterior model loaded from ../distilgpt2
INFO:root:***** Running pretraining *****
INFO:root:  Num Dialogs = 843
INFO:root:  Num Epochs = 50
INFO:root:  Batch size  = 2
INFO:root:warmup epochs:10
INFO:root:Input examples:
INFO:root:<sos_u>  i am looking for a museum to visit? i am pretty excited to be coming in a few weeks. <eos_u> <sos_r>  we have [value_choice]  including the [value_name] . would you like to purchase tickets? <eos_r> <sos_b> [attraction]  name museum <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [attraction] [inform]  name choice [offerbook] <eos_a> <sos_u>  what area of town is that in? <eos_u> <sos_r> [value_name]  is in the [value_area] . <eos_r> <sos_b> [attraction]  name museum <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [attraction] [inform]  name area <eos_a> <sos_u>  great! can i get the address and phone number? <eos_u> <sos_r>  their address is the [value_address] , [value_postcode] . their phone number is [value_phone] . will that be all for today? <eos_r> <sos_b> [attraction]  name cambridge museum of technology <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [attraction] [inform]  address phone postcode [general] [reqmore] <eos_a> <sos_u>  i am also looking for a cheap guest house with free parking and free wifi. <eos_u> <sos_r>  is there a certain area you prefer? <eos_r> <sos_b> [hotel]  parking yes pricerange cheap internet yes type guest house [attraction]  name cambridge museum of technology <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [hotel] [request]  area <eos_a> <sos_u>  let's stick with the east <eos_u> <sos_r> [value_name]  is [value_price]  and [value_stars]  stars with internet and parking located at 517a coldham lane, cb13js. phone number is [value_phone] . can i book a room for you? <eos_r> <sos_b> [hotel]  parking yes pricerange cheap internet yes type guest house area east [attraction]  name cambridge museum of technology <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [hotel] [inform]  name internet parking stars phone price [offerbook] <eos_a> <sos_u>  yes, please book it for 4 people and 3 nights starting from saturday. <eos_u> <sos_r>  you are booked, the reference number is [value_reference] , can i assist with anything else? <eos_r> <sos_b> [hotel]  parking yes pricerange cheap internet yes type guest house area east name allenbell people 4 day saturday stay 3 [attraction]  name cambridge museum of technology <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [hotel] [offerbooked]  reference [general] [reqmore] <eos_a> <sos_u>  thank you, that is all. goodbye. <eos_u> <sos_r>  thank you for using the service today. <eos_r> <sos_b> [hotel]  parking yes pricerange cheap internet yes type guest house area east name allenbell people 4 day saturday stay 3 [attraction]  name cambridge museum of technology <eos_b> <sos_db> [db_nores] <eos_db> <sos_a> [general] [greet] <eos_a>
INFO:root:Input examples:
INFO:root:<sos_u>  need a hotel with free wifi please <eos_u> <sos_r>  is there a specific area you would like to stay in? <eos_r> <sos_b> [hotel]  internet yes <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [hotel] [request]  area <eos_a> <sos_u>  i would like a place with a 4 star rating. <eos_u> <sos_r>  there are [value_choice] [value_stars]  star [value_type]  with free wifi, would you like me to narrow that down with any other details? <eos_r> <sos_b> [hotel]  internet yes stars 4 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [hotel] [inform]  choice internet type stars [general] [reqmore] <eos_a> <sos_u>  could you just pick 1 and book it for 6 people for 2 nights from friday? <eos_u> <sos_r>  did you want it to be in a specific area of town? <eos_r> <sos_b> [hotel]  internet yes stars 4 people 6 day friday stay 2 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [hotel] [request]  area <eos_a> <sos_u>  the area doesn't matter, could you recommend a place? <eos_u> <sos_r> [value_name] , [value_stay]  nights for [value_people]  people beginning [value_day] . your reference number is [value_reference] . is there anything else i can help you with today? <eos_r> <sos_b> [hotel]  internet yes stars 4 people 6 day friday stay 2 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [hotel] [offerbooked]  reference stay name day people [general] [reqmore] <eos_a> <sos_u>  yes, i 'll need a train to cambridge that same day, please. i 'll be leaving from bishops stortford after 12:45. <eos_u> <sos_r>  the [value_id]  leaves at [value_leave] , and arrives at [value_arrive] . would you like to book it? <eos_r> <sos_b> [hotel]  internet yes stars 4 people 6 day friday stay 2 [train]  leave 12:45 destination cambridge day friday departure bishops stortford <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [inform]  arrive id leave [offerbook] <eos_a> <sos_u>  can you just give me the price on it please? <eos_u> <sos_r>  the price for this train ticket is [value_price] . do you need anything else? <eos_r> <sos_b> [hotel]  internet yes stars 4 people 6 day friday stay 2 [train]  leave 12:45 destination cambridge day friday departure bishops stortford <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [inform]  price [general] [reqmore] <eos_a> <sos_u>  no, that is it. thanks! <eos_u> <sos_r>  alright. have a great day. <eos_r> <sos_b> [hotel]  internet yes stars 4 people 6 day friday stay 2 [train]  leave 12:45 destination cambridge day friday departure bishops stortford <eos_b> <sos_db> [db_nores] <eos_db> <sos_a> [general] [greet] <eos_a>
INFO:root:Epoch:0, Train epoch time: 0.96 min, loss: 21.9570784456853
INFO:root:model evaluation loss:6.913970772236112
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:1, Train epoch time: 0.96 min, loss: 6.355007096075676
INFO:root:model evaluation loss:4.144108674355915
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:2, Train epoch time: 0.96 min, loss: 4.0945443110846576
INFO:root:model evaluation loss:3.2359883274350847
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:3, Train epoch time: 0.96 min, loss: 3.288408944864228
INFO:root:model evaluation loss:2.652588274743822
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:4, Train epoch time: 0.95 min, loss: 2.7548616469745904
INFO:root:model evaluation loss:2.2817207759334925
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:5, Train epoch time: 0.96 min, loss: 2.559380761334594
INFO:root:model evaluation loss:2.117201743854417
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:6, Train epoch time: 0.95 min, loss: 2.3068205994059783
INFO:root:model evaluation loss:1.7747909310791228
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:7, Train epoch time: 0.97 min, loss: 1.9009660960922778
INFO:root:model evaluation loss:1.5294299544323058
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:8, Train epoch time: 0.95 min, loss: 1.5892846883742462
INFO:root:model evaluation loss:1.2374781145462914
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:9, Train epoch time: 0.95 min, loss: 1.2482711774922313
INFO:root:model evaluation loss:0.8755071708370769
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:10, Train epoch time: 0.94 min, loss: 0.9746654663287418
INFO:root:model evaluation loss:0.716513323582827
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:11, Train epoch time: 0.95 min, loss: 0.8049831631737696
INFO:root:model evaluation loss:0.6228765306609964
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:12, Train epoch time: 0.95 min, loss: 0.7236551855091757
INFO:root:model evaluation loss:0.5406585555701029
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:13, Train epoch time: 0.95 min, loss: 0.6162250821299396
INFO:root:model evaluation loss:0.4898709822446108
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:14, Train epoch time: 0.95 min, loss: 0.5591266219954536
INFO:root:model evaluation loss:0.44996809158178547
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:15, Train epoch time: 0.95 min, loss: 0.5185856933534985
INFO:root:model evaluation loss:0.44613798258323517
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:16, Train epoch time: 0.94 min, loss: 0.4689231277771399
INFO:root:model evaluation loss:0.39970312424240606
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:17, Train epoch time: 0.94 min, loss: 0.43288169538890814
INFO:root:model evaluation loss:0.37467380867354455
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:18, Train epoch time: 0.96 min, loss: 0.40492159336315636
INFO:root:model evaluation loss:0.3555360899144222
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:19, Train epoch time: 0.95 min, loss: 0.3746506645925728
INFO:root:model evaluation loss:0.34192893067227
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:20, Train epoch time: 0.95 min, loss: 0.35169815662111475
INFO:root:model evaluation loss:0.3259773779926555
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:21, Train epoch time: 0.95 min, loss: 0.3312888955566245
INFO:root:model evaluation loss:0.3146621750165073
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:22, Train epoch time: 0.95 min, loss: 0.3167951694151885
INFO:root:model evaluation loss:0.29625952974080094
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:23, Train epoch time: 0.95 min, loss: 0.2922580836629364
INFO:root:model evaluation loss:0.2873715916944165
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:24, Train epoch time: 0.95 min, loss: 0.2756976736840648
INFO:root:model evaluation loss:0.27876775503335965
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:25, Train epoch time: 0.95 min, loss: 0.2635387550217445
INFO:root:model evaluation loss:0.270146728670668
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:26, Train epoch time: 0.95 min, loss: 0.248450804685413
INFO:root:model evaluation loss:0.2642956596193096
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:27, Train epoch time: 0.95 min, loss: 0.23900524641391538
INFO:root:model evaluation loss:0.2555475166984021
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:28, Train epoch time: 0.95 min, loss: 0.22994492214365464
INFO:root:model evaluation loss:0.2518261402756685
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:29, Train epoch time: 0.95 min, loss: 0.21854689357880974
INFO:root:model evaluation loss:0.2427378368401338
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:30, Train epoch time: 0.95 min, loss: 0.20917768850310448
INFO:root:model evaluation loss:0.24792078168441853
INFO:root:early stop count:4
INFO:root:Epoch:31, Train epoch time: 0.95 min, loss: 0.20227833033185189
INFO:root:model evaluation loss:0.2437519828921982
INFO:root:early stop count:3
INFO:root:Epoch:32, Train epoch time: 0.95 min, loss: 0.19551646307617987
INFO:root:model evaluation loss:0.2344249596907979
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:33, Train epoch time: 0.95 min, loss: 0.18848293139533678
INFO:root:model evaluation loss:0.2362919088216528
INFO:root:early stop count:4
INFO:root:Epoch:34, Train epoch time: 0.95 min, loss: 0.18080498050775887
INFO:root:model evaluation loss:0.23256844150582476
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:35, Train epoch time: 0.95 min, loss: 0.17415711741474732
INFO:root:model evaluation loss:0.22887392788534128
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:36, Train epoch time: 0.95 min, loss: 0.16990979739679068
INFO:root:model evaluation loss:0.23002574206995113
INFO:root:early stop count:4
INFO:root:Epoch:37, Train epoch time: 0.96 min, loss: 0.16634949202924756
INFO:root:model evaluation loss:0.2250204772895409
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:38, Train epoch time: 0.95 min, loss: 0.1617863641137983
INFO:root:model evaluation loss:0.22559342168951554
INFO:root:early stop count:4
INFO:root:Epoch:39, Train epoch time: 0.95 min, loss: 0.15830876392163687
INFO:root:model evaluation loss:0.22521038175309224
INFO:root:early stop count:3
INFO:root:Epoch:40, Train epoch time: 0.94 min, loss: 0.15521624444288687
INFO:root:model evaluation loss:0.2214103593446669
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:41, Train epoch time: 0.94 min, loss: 0.15139451402375045
INFO:root:model evaluation loss:0.2230857850702864
INFO:root:early stop count:4
INFO:root:Epoch:42, Train epoch time: 0.95 min, loss: 0.14668433078534096
INFO:root:model evaluation loss:0.221356513703035
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:43, Train epoch time: 0.95 min, loss: 0.14741689305066047
INFO:root:model evaluation loss:0.22142162392034181
INFO:root:early stop count:4
INFO:root:Epoch:44, Train epoch time: 0.95 min, loss: 0.14361744329001003
INFO:root:model evaluation loss:0.22190606906743987
INFO:root:early stop count:3
INFO:root:Epoch:45, Train epoch time: 0.91 min, loss: 0.14159473400462436
INFO:root:model evaluation loss:0.2188045666996567
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:46, Train epoch time: 0.91 min, loss: 0.13979661438456722
INFO:root:model evaluation loss:0.21805829494186338
INFO:root:Saving model checkpoint to ./experiments_21/all_pre_pos10_act_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Epoch:47, Train epoch time: 0.91 min, loss: 0.13916381539016123
INFO:root:model evaluation loss:0.21915176850817505
INFO:root:early stop count:4
INFO:root:Epoch:48, Train epoch time: 0.91 min, loss: 0.1369879766336769
INFO:root:model evaluation loss:0.21913205495192892
INFO:root:early stop count:3
INFO:root:Epoch:49, Train epoch time: 0.90 min, loss: 0.13771035174944135
INFO:root:model evaluation loss:0.21913205495192892
INFO:root:early stop count:2
