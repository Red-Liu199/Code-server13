INFO:transformers.tokenization_utils:Model name 'best_model' not found in model shortcut name list (gpt2, gpt2-medium, gpt2-large, gpt2-xl, distilgpt2). Assuming 'best_model' is a path, a model identifier, or url to a directory containing tokenizer files.
INFO:transformers.tokenization_utils:loading file best_model/vocab.json
INFO:transformers.tokenization_utils:loading file best_model/merges.txt
INFO:transformers.tokenization_utils:loading file best_model/added_tokens.json
INFO:transformers.tokenization_utils:loading file best_model/special_tokens_map.json
INFO:transformers.tokenization_utils:loading file best_model/tokenizer_config.json
INFO:root:hotel database path:db/hotel_db_processed.json
INFO:transformers.tokenization_utils:Adding [book] to the vocabulary
INFO:transformers.tokenization_utils:Adding [fail_book] to the vocabulary
INFO:transformers.tokenization_utils:Adding [fail_info] to the vocabulary
INFO:transformers.tokenization_utils:Adding [pre_invalid] to the vocabulary
INFO:transformers.tokenization_utils:Adding [invalid] to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_g> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_g> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_ua> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_ua> to the vocabulary
INFO:transformers.tokenization_utils:Assigning ['[restaurant]', '[hotel]', '[attraction]', '[train]', '[taxi]', '[police]', '[hospital]', '[general]', '[inform]', '[request]', '[nooffer]', '[recommend]', '[select]', '[offerbook]', '[offerbooked]', '[nobook]', '[bye]', '[greet]', '[reqmore]', '[welcome]', '[value_name]', '[value_choice]', '[value_area]', '[value_price]', '[value_type]', '[value_reference]', '[value_phone]', '[value_address]', '[value_food]', '[value_leave]', '[value_postcode]', '[value_id]', '[value_arrive]', '[value_stars]', '[value_day]', '[value_destination]', '[value_car]', '[value_departure]', '[value_time]', '[value_people]', '[value_stay]', '[value_pricerange]', '[value_department]', '[value_name]([value_phone]', '<pad>', '<go_r>', '<unk>', '<go_b>', '<go_a>', '<eos_u>', '<eos_r>', '<eos_b>', '<eos_a>', '<go_d>', '<eos_d>', '<sos_u>', '<sos_r>', '<sos_b>', '<sos_a>', '<sos_d>', '<sos_db>', '<eos_db>', '[db_nores]', '[db_0]', '[db_1]', '[db_2]', '[db_3]', '[book]', '[fail_book]', '[fail_info]', '[pre_invalid]', '[invalid]', '<sos_g>', '<eos_g>', '<sos_ua>', '<eos_ua>'] to the additional_special_tokens key of the tokenizer
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Encoding data now and save the encoded data in ./data/multi-woz-2.1-processed/encoded_us_data.json
INFO:transformers.tokenization_utils:Model name '../distilgpt2' not found in model shortcut name list (gpt2, gpt2-medium, gpt2-large, gpt2-xl, distilgpt2). Assuming '../distilgpt2' is a path, a model identifier, or url to a directory containing tokenizer files.
INFO:transformers.tokenization_utils:Didn't find file ../distilgpt2/added_tokens.json. We won't load it.
INFO:transformers.tokenization_utils:Didn't find file ../distilgpt2/special_tokens_map.json. We won't load it.
INFO:transformers.tokenization_utils:Didn't find file ../distilgpt2/tokenizer_config.json. We won't load it.
INFO:transformers.tokenization_utils:loading file ../distilgpt2/vocab.json
INFO:transformers.tokenization_utils:loading file ../distilgpt2/merges.txt
INFO:transformers.tokenization_utils:loading file None
INFO:transformers.tokenization_utils:loading file None
INFO:transformers.tokenization_utils:loading file None
INFO:root:hotel database path:db/hotel_db_processed.json
INFO:transformers.tokenization_utils:Adding [restaurant] to the vocabulary
INFO:transformers.tokenization_utils:Adding [hotel] to the vocabulary
INFO:transformers.tokenization_utils:Adding [attraction] to the vocabulary
INFO:transformers.tokenization_utils:Adding [train] to the vocabulary
INFO:transformers.tokenization_utils:Adding [taxi] to the vocabulary
INFO:transformers.tokenization_utils:Adding [police] to the vocabulary
INFO:transformers.tokenization_utils:Adding [hospital] to the vocabulary
INFO:transformers.tokenization_utils:Adding [general] to the vocabulary
INFO:transformers.tokenization_utils:Adding [inform] to the vocabulary
INFO:transformers.tokenization_utils:Adding [request] to the vocabulary
INFO:transformers.tokenization_utils:Adding [nooffer] to the vocabulary
INFO:transformers.tokenization_utils:Adding [recommend] to the vocabulary
INFO:transformers.tokenization_utils:Adding [select] to the vocabulary
INFO:transformers.tokenization_utils:Adding [offerbook] to the vocabulary
INFO:transformers.tokenization_utils:Adding [offerbooked] to the vocabulary
INFO:transformers.tokenization_utils:Adding [nobook] to the vocabulary
INFO:transformers.tokenization_utils:Adding [bye] to the vocabulary
INFO:transformers.tokenization_utils:Adding [greet] to the vocabulary
INFO:transformers.tokenization_utils:Adding [reqmore] to the vocabulary
INFO:transformers.tokenization_utils:Adding [welcome] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_name] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_choice] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_area] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_price] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_type] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_reference] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_phone] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_address] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_food] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_leave] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_postcode] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_id] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_arrive] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_stars] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_day] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_destination] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_car] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_departure] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_time] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_people] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_stay] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_pricerange] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_department] to the vocabulary
INFO:transformers.tokenization_utils:Adding [value_name]([value_phone] to the vocabulary
INFO:transformers.tokenization_utils:Adding <pad> to the vocabulary
INFO:transformers.tokenization_utils:Adding <go_r> to the vocabulary
INFO:transformers.tokenization_utils:Adding <unk> to the vocabulary
INFO:transformers.tokenization_utils:Adding <go_b> to the vocabulary
INFO:transformers.tokenization_utils:Adding <go_a> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_u> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_r> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_b> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_a> to the vocabulary
INFO:transformers.tokenization_utils:Adding <go_d> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_d> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_u> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_r> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_b> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_a> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_d> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_db> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_db> to the vocabulary
INFO:transformers.tokenization_utils:Adding [db_nores] to the vocabulary
INFO:transformers.tokenization_utils:Adding [db_0] to the vocabulary
INFO:transformers.tokenization_utils:Adding [db_1] to the vocabulary
INFO:transformers.tokenization_utils:Adding [db_2] to the vocabulary
INFO:transformers.tokenization_utils:Adding [db_3] to the vocabulary
INFO:transformers.tokenization_utils:Adding [book] to the vocabulary
INFO:transformers.tokenization_utils:Adding [fail_book] to the vocabulary
INFO:transformers.tokenization_utils:Adding [fail_info] to the vocabulary
INFO:transformers.tokenization_utils:Adding [pre_invalid] to the vocabulary
INFO:transformers.tokenization_utils:Adding [invalid] to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_g> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_g> to the vocabulary
INFO:transformers.tokenization_utils:Adding <sos_ua> to the vocabulary
INFO:transformers.tokenization_utils:Adding <eos_ua> to the vocabulary
INFO:transformers.tokenization_utils:Assigning ['[restaurant]', '[hotel]', '[attraction]', '[train]', '[taxi]', '[police]', '[hospital]', '[general]', '[inform]', '[request]', '[nooffer]', '[recommend]', '[select]', '[offerbook]', '[offerbooked]', '[nobook]', '[bye]', '[greet]', '[reqmore]', '[welcome]', '[value_name]', '[value_choice]', '[value_area]', '[value_price]', '[value_type]', '[value_reference]', '[value_phone]', '[value_address]', '[value_food]', '[value_leave]', '[value_postcode]', '[value_id]', '[value_arrive]', '[value_stars]', '[value_day]', '[value_destination]', '[value_car]', '[value_departure]', '[value_time]', '[value_people]', '[value_stay]', '[value_pricerange]', '[value_department]', '[value_name]([value_phone]', '<pad>', '<go_r>', '<unk>', '<go_b>', '<go_a>', '<eos_u>', '<eos_r>', '<eos_b>', '<eos_a>', '<go_d>', '<eos_d>', '<sos_u>', '<sos_r>', '<sos_b>', '<sos_a>', '<sos_d>', '<sos_db>', '<eos_db>', '[db_nores]', '[db_0]', '[db_1]', '[db_2]', '[db_3]', '[book]', '[fail_book]', '[fail_info]', '[pre_invalid]', '[invalid]', '<sos_g>', '<eos_g>', '<sos_ua>', '<eos_ua>'] to the additional_special_tokens key of the tokenizer
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/encoded_us_data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:transformers.configuration_utils:loading configuration file ../distilgpt2/config.json
INFO:transformers.configuration_utils:Model config GPT2Config {
  "_num_labels": 1,
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "id2label": {
    "0": "LABEL_0"
  },
  "initializer_range": 0.02,
  "label2id": {
    "LABEL_0": 0
  },
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_layer": 6,
  "n_positions": 1024,
  "resid_pdrop": 0.1,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "vocab_size": 50257
}

INFO:transformers.modeling_utils:loading weights file ../distilgpt2/pytorch_model.bin
INFO:transformers.modeling_utils:Weights of GPT2LMHeadModel not initialized from pretrained model: ['transformer.h.0.attn.masked_bias', 'transformer.h.1.attn.masked_bias', 'transformer.h.2.attn.masked_bias', 'transformer.h.3.attn.masked_bias', 'transformer.h.4.attn.masked_bias', 'transformer.h.5.attn.masked_bias']
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running pretraining *****
INFO:root:  Num Dialogs = 8434
INFO:root:  Num Epochs = 60
INFO:root:  Batch size  = 2
INFO:root:warmup epochs:7
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  leave 13:15 destination ely day thursday departure cambridge [fail_info] [book] [invalid]  no people 8 [fail_book] [restaurant] [inform]  food indian pricerange cheap area centre [fail_info]  food english pricerange cheap area centre [book]  people 8 day monday [invalid]  no time 16:30 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  price cheap <eos_ua> <sos_u>  i need a place to eat that is cheap. <eos_u> <sos_r>  i have [value_choice] [value_price]  restaurant -s in different area -s of town. do you have a location preference? <eos_r> <sos_ua> [restaurant] [inform]  area centre <eos_ua> <sos_u>  yes. i want the center area. <eos_u> <sos_r>  i can recommend [value_name]  that serves [value_food]  food <eos_r> <sos_ua> [restaurant] [inform]  food english <eos_ua> <sos_u>  do you have any restaurant -s that serve english food? <eos_u> <sos_r>  i am showing nothing for [value_food]  food in the [value_area]  area. would you like to try something else? <eos_r> <sos_ua> [restaurant] [inform]  food indian time 16:30 day monday people 8 <eos_ua> <sos_u>  how about some awesome indian food. i need a table for 8 on 16:30 monday <eos_u> <sos_r>  i booked you at [value_name] . the table will be reserved for 15 minutes. reference number is : [value_reference] . is there anything else i can help you with? <eos_r> <sos_ua> [train] [inform]  day thursday departure cambridge <eos_ua> <sos_u>  thanks for your help. in addition, i am looking for a thursday train departing cambridge, please. <eos_u> <sos_r>  there are [value_choice]  trains leaving [value_departure]  on [value_day] . where is your destination? <eos_r> <sos_ua> [train] [inform]  destination ely leave 13:15 <eos_ua> <sos_u>  i am looking to travel to ely departing after 13:15 if possible. <eos_u> <sos_r>  the [value_id]  leaves at [value_leave]  on [value_day] . would you like me to book you? <eos_r> <sos_ua> [train] [inform]  people 8 <eos_ua> <sos_u>  yes, please book 8 tickets and provide me with a reference number <eos_u> <sos_r>  okay i have booked that for you and the reference number is [value_reference] . is there anything else i can do for you? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  great, thanks. that is all for now! <eos_u> <sos_r>  ok. i hope you have a great day! <eos_r>
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  destination cambridge day friday arrive 13:00 departure ely [fail_info] [book] [invalid]  no people 2 [fail_book] [restaurant] [inform]  name kohinoor [fail_info] [book]  people 2 day thursday [invalid]  no time 16:45 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  none none <eos_ua> <sos_u>  i need to find some information in a particular restaurant. are you able to look up a specific place? <eos_u> <sos_r>  absolutely. what is the name of the restaraunt you are interested in? <eos_r> <sos_ua> [restaurant] [inform]  name kohinoor time 16:45 day thursday people 2 <eos_ua> <sos_u>  kohinoor. i want to book a table for 2 people at 16:45 on thursday <eos_u> <sos_r>  sure. booking was successful. the table will be reserved for 15 minutes. reference number is : [value_reference] . can i help with anything else today? <eos_r> <sos_ua> [train] [inform]  day thursday <eos_ua> <sos_u>  i also need a thursday train. <eos_u> <sos_r>  what location will you depart from and where are you headed? <eos_r> <sos_ua> [train] [inform]  destination cambridge arrive 13:00 departure ely people 2 <eos_ua> <sos_u>  depart from ely and would like to arrive by 13:00 in cambridge. i need to book it for 2 people i also need a reference number. thanks <eos_u> <sos_r>  sure thing, it is booked and your reference number is [value_reference] . do you need more help? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  nope, i am all finished for today. thanks so much, goodbye now! <eos_u> <sos_r>  you are very welcome, bye! <eos_r>
INFO:root:Epoch:0, Train epoch time: 5.77 min, loss: 12.96175973473084
INFO:root:model evaluation loss:3.7067421669997866
INFO:root:Saving model checkpoint to ./experiments_21/all_test_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:transformers.configuration_utils:Configuration saved in ./experiments_21/all_test_sd11_lr0.0001_bs2_ga16/best_loss_model/config.json
INFO:transformers.modeling_utils:Model weights saved in ./experiments_21/all_test_sd11_lr0.0001_bs2_ga16/best_loss_model/pytorch_model.bin
INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/encoded_us_data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running pretraining *****
INFO:root:  Num Dialogs = 8434
INFO:root:  Num Epochs = 60
INFO:root:  Batch size  = 2
INFO:root:warmup epochs:7
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  leave 13:15 destination ely day thursday departure cambridge [fail_info] [book] [invalid]  no people 8 [fail_book] [restaurant] [inform]  food indian pricerange cheap area centre [fail_info]  food english pricerange cheap area centre [book]  people 8 day monday [invalid]  no time 16:30 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  price cheap <eos_ua> <sos_u>  i need a place to eat that is cheap. <eos_u> <sos_r>  i have [value_choice] [value_price]  restaurant -s in different area -s of town. do you have a location preference? <eos_r> <sos_ua> [restaurant] [inform]  area centre <eos_ua> <sos_u>  yes. i want the center area. <eos_u> <sos_r>  i can recommend [value_name]  that serves [value_food]  food <eos_r> <sos_ua> [restaurant] [inform]  food english <eos_ua> <sos_u>  do you have any restaurant -s that serve english food? <eos_u> <sos_r>  i am showing nothing for [value_food]  food in the [value_area]  area. would you like to try something else? <eos_r> <sos_ua> [restaurant] [inform]  food indian time 16:30 day monday people 8 <eos_ua> <sos_u>  how about some awesome indian food. i need a table for 8 on 16:30 monday <eos_u> <sos_r>  i booked you at [value_name] . the table will be reserved for 15 minutes. reference number is : [value_reference] . is there anything else i can help you with? <eos_r> <sos_ua> [train] [inform]  day thursday departure cambridge <eos_ua> <sos_u>  thanks for your help. in addition, i am looking for a thursday train departing cambridge, please. <eos_u> <sos_r>  there are [value_choice]  trains leaving [value_departure]  on [value_day] . where is your destination? <eos_r> <sos_ua> [train] [inform]  destination ely leave 13:15 <eos_ua> <sos_u>  i am looking to travel to ely departing after 13:15 if possible. <eos_u> <sos_r>  the [value_id]  leaves at [value_leave]  on [value_day] . would you like me to book you? <eos_r> <sos_ua> [train] [inform]  people 8 <eos_ua> <sos_u>  yes, please book 8 tickets and provide me with a reference number <eos_u> <sos_r>  okay i have booked that for you and the reference number is [value_reference] . is there anything else i can do for you? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  great, thanks. that is all for now! <eos_u> <sos_r>  ok. i hope you have a great day! <eos_r>
INFO:root:Input examples:
INFO:root:<sos_g> [train] [inform]  destination cambridge day friday arrive 13:00 departure ely [fail_info] [book] [invalid]  no people 2 [fail_book] [restaurant] [inform]  name kohinoor [fail_info] [book]  people 2 day thursday [invalid]  no time 16:45 [fail_book] <eos_g> <sos_ua> [restaurant] [inform]  none none <eos_ua> <sos_u>  i need to find some information in a particular restaurant. are you able to look up a specific place? <eos_u> <sos_r>  absolutely. what is the name of the restaraunt you are interested in? <eos_r> <sos_ua> [restaurant] [inform]  name kohinoor time 16:45 day thursday people 2 <eos_ua> <sos_u>  kohinoor. i want to book a table for 2 people at 16:45 on thursday <eos_u> <sos_r>  sure. booking was successful. the table will be reserved for 15 minutes. reference number is : [value_reference] . can i help with anything else today? <eos_r> <sos_ua> [train] [inform]  day thursday <eos_ua> <sos_u>  i also need a thursday train. <eos_u> <sos_r>  what location will you depart from and where are you headed? <eos_r> <sos_ua> [train] [inform]  destination cambridge arrive 13:00 departure ely people 2 <eos_ua> <sos_u>  depart from ely and would like to arrive by 13:00 in cambridge. i need to book it for 2 people i also need a reference number. thanks <eos_u> <sos_r>  sure thing, it is booked and your reference number is [value_reference] . do you need more help? <eos_r> <sos_ua> [general]  [thank] <eos_ua> <sos_u>  nope, i am all finished for today. thanks so much, goodbye now! <eos_u> <sos_r>  you are very welcome, bye! <eos_r>
INFO:root:Epoch:0, Train epoch time: 7.06 min, loss: 12.96175973473084
INFO:root:model evaluation loss:3.7067421669997866
INFO:root:Saving model checkpoint to ./experiments_21/all_test_sd11_lr0.0001_bs2_ga16/best_loss_model
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
