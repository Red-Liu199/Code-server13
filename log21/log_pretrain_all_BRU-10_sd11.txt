INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 1501
INFO:root:  Num Turns = 5714
INFO:root:  Num Dialogs = 843
INFO:root:  Num Epochs = 50
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 9381
INFO:root:Input examples:
INFO:root:<sos_u>  i need to find a train that leaves on saturday and arrives by 08:45 <eos_u> <sos_b> [train]  day saturday arrive 08:45 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [request]  departure destination <eos_a> <sos_r>  can you tell me what your departure city and destination are? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 <eos_b> <sos_r>  can you tell me what your departure city and destination are? <eos_r> <sos_u>  i 'll be leaving cambridge to get to ely. <eos_u> <sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, can you book that for 7? <eos_u> <sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [offerbooked]  reference price [general] [reqmore] <eos_a> <sos_r>  booking was successful, the total fee is [value_price]  payable at the station, you reference number is [value_reference] . will that be all? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_r>  booking was successful, the total fee is [value_price]  payable at the station, you reference number is [value_reference] . will that be all? <eos_r> <sos_u>  are there anything fun to do in city centre? <eos_u> <sos_b> [attraction]  area centre [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  my favorite attraction in the [value_area]  is a [value_type]  called [value_name] . it is amazing! they are at [value_address] . <eos_r>
INFO:root:Epoch:0, Train epoch time: 2.20 min, epoch loss: 20917.4292
INFO:root:Epoch:1, Train epoch time: 2.23 min, epoch loss: 5369.9515
INFO:root:Epoch:2, Train epoch time: 2.29 min, epoch loss: 3946.4294
INFO:root:Epoch:3, Train epoch time: 2.29 min, epoch loss: 2954.2449
INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 1501
INFO:root:  Num Turns = 5714
INFO:root:  Num Dialogs = 843
INFO:root:  Num Epochs = 50
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 9381
INFO:root:Input examples:
INFO:root:<sos_u>  i need to find a train that leaves on saturday and arrives by 08:45 <eos_u> <sos_b> [train]  day saturday arrive 08:45 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [request]  departure destination <eos_a> <sos_r>  can you tell me what your departure city and destination are? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 <eos_b> <sos_r>  can you tell me what your departure city and destination are? <eos_r> <sos_u>  i 'll be leaving cambridge to get to ely. <eos_u> <sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, can you book that for 7? <eos_u> <sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_db> [db_2] <eos_db> <sos_a> [train] [offerbooked]  reference price [general] [reqmore] <eos_a> <sos_r>  booking was successful, the total fee is [value_price]  payable at the station, you reference number is [value_reference] . will that be all? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_r>  booking was successful, the total fee is [value_price]  payable at the station, you reference number is [value_reference] . will that be all? <eos_r> <sos_u>  are there anything fun to do in city centre? <eos_u> <sos_b> [attraction]  area centre [train]  day saturday arrive 08:45 destination ely departure cambridge people 7 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  my favorite attraction in the [value_area]  is a [value_type]  called [value_name] . it is amazing! they are at [value_address] . <eos_r>
INFO:root:Epoch:0, Train epoch time: 2.29 min, epoch loss: 20917.4292
INFO:root:Epoch:1, Train epoch time: 2.29 min, epoch loss: 5369.9515
INFO:root:Epoch:2, Train epoch time: 2.22 min, epoch loss: 3946.4294
INFO:root:Epoch:3, Train epoch time: 2.26 min, epoch loss: 2954.2449
INFO:root:Epoch:4, Train epoch time: 2.24 min, epoch loss: 2216.2822
INFO:root:Epoch:5, Train epoch time: 2.26 min, epoch loss: 1835.0323
INFO:root:Epoch:6, Train epoch time: 2.22 min, epoch loss: 1596.2490
INFO:root:Inference time:6.049 min
INFO:root:validation [CTR] 72.85  38.08  9.39  64.85  0.098
INFO:root:validation 45.69  24.75  9.39  44.61  0.098
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:7, Train epoch time: 2.24 min, epoch loss: 1428.9953
INFO:root:Inference time:5.353 min
INFO:root:validation [CTR] 74.55  37.27  8.07  63.99  0.129
INFO:root:validation 48.70  24.15  8.07  44.50  0.129
INFO:root:Epoch:8, Train epoch time: 2.16 min, epoch loss: 1310.6017
INFO:root:Inference time:5.217 min
INFO:root:validation [CTR] 72.14  56.01  11.18  75.25  0.172
INFO:root:validation 50.00  39.98  11.18  56.17  0.172
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:9, Train epoch time: 2.17 min, epoch loss: 1203.9241
INFO:root:Inference time:6.532 min
INFO:root:validation [CTR] 60.22  48.50  12.14  66.50  0.161
INFO:root:validation 42.48  34.47  12.14  50.61  0.161
INFO:root:Epoch:10, Train epoch time: 2.16 min, epoch loss: 1116.4320
INFO:root:Inference time:6.358 min
INFO:root:validation [CTR] 81.76  50.00  10.22  76.10  0.208
INFO:root:validation 61.92  38.78  10.22  60.57  0.208
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:11, Train epoch time: 2.17 min, epoch loss: 1045.4811
INFO:root:Inference time:5.604 min
INFO:root:validation [CTR] 81.96  58.92  12.05  82.49  0.257
INFO:root:validation 62.42  45.79  12.05  66.16  0.257
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:12, Train epoch time: 2.16 min, epoch loss: 982.7939
INFO:root:Inference time:5.584 min
INFO:root:validation [CTR] 66.83  44.39  11.16  66.77  0.276
INFO:root:validation 56.21  37.88  11.16  58.21  0.276
INFO:root:early stop count:4
INFO:root:Epoch:13, Train epoch time: 2.15 min, epoch loss: 930.3796
INFO:root:Inference time:5.772 min
INFO:root:validation [CTR] 58.12  45.29  14.75  66.45  0.294
INFO:root:validation 54.01  41.98  14.75  62.74  0.294
INFO:root:early stop count:3
INFO:root:Epoch:14, Train epoch time: 2.01 min, epoch loss: 884.1240
INFO:root:Inference time:5.701 min
INFO:root:validation [CTR] 79.16  64.73  14.71  86.65  0.292
INFO:root:validation 68.74  55.91  14.71  77.03  0.292
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:15, Train epoch time: 2.13 min, epoch loss: 846.8378
INFO:root:Inference time:5.819 min
INFO:root:validation [CTR] 67.64  56.71  13.93  76.11  0.301
INFO:root:validation 62.12  51.40  13.93  70.70  0.301
INFO:root:early stop count:4
INFO:root:Epoch:16, Train epoch time: 2.14 min, epoch loss: 804.8583
INFO:root:Inference time:6.002 min
INFO:root:validation [CTR] 78.46  66.43  14.83  87.28  0.278
INFO:root:validation 66.63  56.31  14.83  76.31  0.278
INFO:root:early stop count:3
INFO:root:Epoch:17, Train epoch time: 2.09 min, epoch loss: 772.0479
INFO:root:Inference time:5.175 min
INFO:root:validation [CTR] 77.66  60.92  14.05  83.34  0.308
INFO:root:validation 68.44  53.51  14.05  75.02  0.308
INFO:root:early stop count:2
INFO:root:Epoch:18, Train epoch time: 2.09 min, epoch loss: 737.6321
INFO:root:Inference time:5.224 min
INFO:root:validation [CTR] 73.55  56.21  12.40  77.28  0.306
INFO:root:validation 65.23  49.60  12.40  69.81  0.306
INFO:root:early stop count:1
INFO:root:Epoch:19, Train epoch time: 2.08 min, epoch loss: 707.5785
INFO:root:Inference time:5.410 min
INFO:root:validation [CTR] 73.15  59.32  14.35  80.58  0.324
INFO:root:validation 64.83  52.71  14.35  73.12  0.324
INFO:root:early stop count:0
INFO:root:Epoch:20, Train epoch time: 2.11 min, epoch loss: 678.1446
INFO:root:Inference time:5.270 min
INFO:root:validation [CTR] 66.93  55.61  14.38  75.65  0.326
INFO:root:validation 61.72  51.30  14.38  70.89  0.326
INFO:root:early stop count:-1
INFO:root:Epoch:21, Train epoch time: 2.12 min, epoch loss: 651.3404
INFO:root:Inference time:5.202 min
INFO:root:validation [CTR] 78.16  65.13  13.74  85.38  0.316
INFO:root:validation 69.74  58.22  13.74  77.72  0.316
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:22, Train epoch time: 2.13 min, epoch loss: 627.9846
INFO:root:Inference time:5.339 min
INFO:root:validation [CTR] 79.86  66.03  14.27  87.22  0.320
INFO:root:validation 73.05  60.52  14.27  81.05  0.320
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:23, Train epoch time: 2.12 min, epoch loss: 603.7606
INFO:root:Inference time:5.245 min
INFO:root:validation [CTR] 83.67  65.43  13.49  88.04  0.320
INFO:root:validation 73.75  57.11  13.49  78.92  0.320
INFO:root:early stop count:4
INFO:root:Epoch:24, Train epoch time: 2.12 min, epoch loss: 578.6648
INFO:root:Inference time:5.122 min
INFO:root:validation [CTR] 80.96  67.03  12.87  86.87  0.313
INFO:root:validation 73.65  61.12  12.87  80.25  0.313
INFO:root:early stop count:3
INFO:root:Epoch:25, Train epoch time: 2.11 min, epoch loss: 560.0996
INFO:root:Inference time:5.362 min
INFO:root:validation [CTR] 82.16  67.23  14.19  88.89  0.315
INFO:root:validation 71.84  58.72  14.19  79.47  0.315
INFO:root:early stop count:2
INFO:root:Epoch:26, Train epoch time: 2.11 min, epoch loss: 539.3481
INFO:root:Inference time:5.149 min
INFO:root:validation [CTR] 73.85  58.42  12.32  78.46  0.333
INFO:root:validation 68.64  54.21  12.32  73.75  0.333
INFO:root:early stop count:1
INFO:root:Epoch:27, Train epoch time: 2.12 min, epoch loss: 520.7022
INFO:root:Inference time:5.218 min
INFO:root:validation [CTR] 79.96  64.13  13.45  85.49  0.321
INFO:root:validation 70.04  56.01  13.45  76.48  0.321
INFO:root:early stop count:0
INFO:root:Epoch:28, Train epoch time: 2.12 min, epoch loss: 501.2802
INFO:root:Inference time:5.319 min
INFO:root:validation [CTR] 83.67  69.24  14.26  90.71  0.324
INFO:root:validation 72.14  58.92  14.26  79.79  0.324
INFO:root:early stop count:-1
INFO:root:Epoch:29, Train epoch time: 2.11 min, epoch loss: 484.3652
INFO:root:Inference time:5.206 min
INFO:root:validation [CTR] 79.76  63.83  13.00  84.79  0.327
INFO:root:validation 71.94  57.82  13.00  77.88  0.327
INFO:root:early stop count:-2
INFO:root:Epoch:30, Train epoch time: 2.09 min, epoch loss: 466.2311
INFO:root:Inference time:5.172 min
INFO:root:validation [CTR] 84.87  68.84  13.55  90.40  0.338
INFO:root:validation 76.05  61.62  13.55  82.39  0.338
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:31, Train epoch time: 2.08 min, epoch loss: 452.6135
INFO:root:Inference time:5.086 min
INFO:root:validation [CTR] 86.77  71.54  13.86  93.01  0.328
INFO:root:validation 77.05  63.23  13.86  84.00  0.328
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU-10_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:32, Train epoch time: 2.08 min, epoch loss: 439.3774
INFO:root:Inference time:5.236 min
INFO:root:validation [CTR] 79.76  65.93  13.60  86.44  0.321
INFO:root:validation 71.84  59.32  13.60  79.18  0.321
INFO:root:early stop count:4
INFO:root:Epoch:33, Train epoch time: 2.12 min, epoch loss: 425.8740
INFO:root:Inference time:5.157 min
INFO:root:validation [CTR] 80.86  65.33  13.04  86.14  0.328
INFO:root:validation 72.44  58.42  13.04  78.47  0.328
INFO:root:early stop count:3
INFO:root:Epoch:34, Train epoch time: 2.11 min, epoch loss: 411.6519
INFO:root:Inference time:5.319 min
INFO:root:validation [CTR] 79.06  63.53  13.10  84.39  0.326
INFO:root:validation 72.85  58.32  13.10  78.68  0.326
INFO:root:early stop count:2
INFO:root:Epoch:35, Train epoch time: 2.11 min, epoch loss: 402.0021
INFO:root:Inference time:5.261 min
INFO:root:validation [CTR] 86.47  71.64  13.58  92.64  0.322
INFO:root:validation 75.55  62.42  13.58  82.57  0.322
INFO:root:early stop count:1
INFO:root:Epoch:36, Train epoch time: 2.11 min, epoch loss: 391.4464
INFO:root:Inference time:5.206 min
INFO:root:validation [CTR] 83.17  65.93  13.25  87.80  0.318
INFO:root:validation 73.65  58.42  13.25  79.28  0.318
INFO:root:early stop count:0
INFO:root:Epoch:37, Train epoch time: 2.12 min, epoch loss: 378.8330
INFO:root:Inference time:5.327 min
INFO:root:validation [CTR] 84.77  70.04  13.20  90.60  0.322
INFO:root:validation 77.15  63.23  13.20  83.39  0.322
INFO:root:early stop count:-1
INFO:root:Epoch:38, Train epoch time: 2.12 min, epoch loss: 372.0738
INFO:root:Inference time:5.268 min
INFO:root:validation [CTR] 81.86  63.73  12.96  85.76  0.319
INFO:root:validation 72.65  56.01  12.96  77.29  0.319
INFO:root:early stop count:-2
INFO:root:Epoch:39, Train epoch time: 1.90 min, epoch loss: 363.6265
INFO:root:Inference time:5.285 min
INFO:root:validation [CTR] 82.77  67.84  13.15  88.46  0.330
INFO:root:validation 74.35  61.02  13.15  80.84  0.330
INFO:root:early stop count:-3
INFO:root:Epoch:40, Train epoch time: 2.09 min, epoch loss: 355.3254
INFO:root:Inference time:5.265 min
INFO:root:validation [CTR] 80.26  64.43  12.91  85.25  0.328
INFO:root:validation 71.94  58.02  12.91  77.89  0.328
INFO:root:early stop count:-4
INFO:root:Epoch:41, Train epoch time: 2.08 min, epoch loss: 347.3537
INFO:root:Inference time:5.370 min
INFO:root:validation [CTR] 83.57  68.54  13.35  89.40  0.317
INFO:root:validation 74.35  60.62  13.35  80.84  0.317
INFO:root:early stop count:-5
INFO:root:Epoch:42, Train epoch time: 2.08 min, epoch loss: 342.9519
