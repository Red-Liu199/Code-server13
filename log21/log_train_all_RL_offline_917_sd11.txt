INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:Dialogs per rl epoch:1000
INFO:root:Reward example. BS reward:[1, 1.0, 1.0, 1.0], Act reward:[0.0, 0.33333333333333326, -1.0, 0.33333333333333326], Resp reward:[1, 1, 1, 1], Session reward:0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 1.0], Act reward:[0.0, 1.0, 0.33333333333333326, 1.0], Resp reward:[1, 1, 1, 1], Session reward:0.0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 0.5], Act reward:[1.0, 1.0, 0.0, 1.0], Resp reward:[1, 1, 1, 1], Session reward:0.5
INFO:root:Reward example. BS reward:[1, 1, 1, 1], Act reward:[0.0, 1.0, -1.0, 1.0], Resp reward:[1, 1, 1, 1], Session reward:1.0
INFO:root:Example rewards of one batch :[[(1, 0.0, 1), (1.0, 0.33333333333333326, 1), (1.0, -1.0, 1), (1.0, 0.33333333333333326, 1)], [(1.0, 0.0, 1.0), (1.0, 1.0, 1.0), (1.0, 0.33333333333333326, 1.0), (1.0, 1.0, 1.0)], [(1.5, 1.5, 1.5), (1.5, 1.5, 1.5), (1.5, 0.5, 1.5), (1.0, 1.5, 1.5)], [(2.0, 1.0, 2.0), (2.0, 2.0, 2.0), (2.0, 0.0, 2.0), (2.0, 2.0, 2.0)]]
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:Dialogs per rl epoch:1000
INFO:root:Reward example. BS reward:[1, 1.0, 1.0, 1.0], Act reward:[0.0, 0.33333333333333326, -1.0, 0.33333333333333326], Resp reward:[1, 1, 1, 1], Session reward:0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 1.0], Act reward:[0.0, 1.0, 0.33333333333333326, 1.0], Resp reward:[1, 1, 1, 1], Session reward:0.0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 0.5], Act reward:[1.0, 1.0, 0.0, 1.0], Resp reward:[1, 1, 1, 1], Session reward:0.5
INFO:root:Reward example. BS reward:[1, 1, 1, 1], Act reward:[0.0, 1.0, -1.0, 1.0], Resp reward:[1, 1, 1, 1], Session reward:1.0
INFO:root:Example rewards of one batch :[[(1, 0.0, 1), (1.0, 0.33333333333333326, 1), (1.0, -1.0, 1), (1.0, 0.33333333333333326, 1)], [(1.0, 0.0, 1.0), (1.0, 1.0, 1.0), (1.0, 0.33333333333333326, 1.0), (1.0, 1.0, 1.0)], [(1.5, 1.5, 1.5), (1.5, 1.5, 1.5), (1.5, 0.5, 1.5), (1.0, 1.5, 1.5)], [(2.0, 1.0, 2.0), (2.0, 2.0, 2.0), (2.0, 0.0, 2.0), (2.0, 2.0, 2.0)]]
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 1.0], Act reward:[1.0, 1.0, 1.0, 1.0], Resp reward:[1, 1, 1, 1], Session reward:1.0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 1.0], Act reward:[1.0, 0.19999999999999996, -0.19999999999999996, 1.0], Resp reward:[1, 1, 1, 1], Session reward:0.0
INFO:root:Reward example. BS reward:[1.0, 1.0, 1.0, 1.0], Act reward:[1.0, -0.6666666666666667, 0.5, -1.0], Resp reward:[1, 1, 1, 1], Session reward:0.5
INFO:root:Reward example. BS reward:[1.0, 0.33333333333333326, 0.33333333333333326, 0.33333333333333326], Act reward:[0.0, -0.33333333333333337, 1.0, 0.0], Resp reward:[-1, 1, -1, 1], Session reward:1.0
INFO:root:Example rewards of one batch :[[(2.0, 2.0, 2.0), (2.0, 2.0, 2.0), (2.0, 2.0, 2.0), (2.0, 2.0, 2.0)], [(1.0, 1.0, 1.0), (1.0, 0.19999999999999996, 1.0), (1.0, -0.19999999999999996, 1.0), (1.0, 1.0, 1.0)], [(1.5, 1.5, 1.5), (1.5, -0.16666666666666674, 1.5), (1.5, 1.0, 1.5), (1.5, -0.5, 1.5)], [(2.0, 1.0, 0.0), (1.3333333333333333, 0.6666666666666666, 2.0), (1.3333333333333333, 2.0, 0.0), (1.3333333333333333, 1.0, 2.0)]]
INFO:root:Epoch:0, time:2.886 min
INFO:root:Inference time:5.339641
INFO:root:Dev reward:(11704.701646719319, 6894.080952380956, 12409.33333333333), metrics:(84.969939879751, 73.04609218436141, 15.733757191918462, 94.74177322397466)
INFO:root:Average reward of epoch 0: 12.722924572276648
INFO:root:Epoch:1, time:2.640 min
INFO:root:Inference time:5.211189
INFO:root:Dev reward:(11696.753502379985, 6895.076984126981, 12453.166666666666), metrics:(86.17234468937012, 75.35070140279807, 15.729520767421334, 96.49104381350543)
INFO:root:Average reward of epoch 1: 11.537419866374941
INFO:root:Epoch:2, time:3.644 min
INFO:root:Inference time:5.150492
INFO:root:Dev reward:(11752.18606703753, 6938.501587301575, 12380.500000000002), metrics:(85.17034068135419, 73.84769539077416, 15.572012616232508, 95.08103065229669)
INFO:root:Average reward of epoch 2: 15.801324715833854
INFO:root:Epoch:3, time:2.520 min
INFO:root:Inference time:5.059490
INFO:root:Dev reward:(11720.730289808233, 6940.292857142864, 12409.333333333334), metrics:(86.17234468937012, 74.04809619237734, 15.791548554135723, 95.90176899500946)
INFO:root:Average reward of epoch 3: 12.269901669511045
INFO:root:Epoch:4, time:3.616 min
INFO:root:Inference time:5.192402
INFO:root:Dev reward:(11730.437991093875, 6973.265873015874, 12412.833333333334), metrics:(85.17034068135419, 74.7494989979885, 15.675097631163554, 95.6350174708349)
INFO:root:Average reward of epoch 4: 15.840137511972298
INFO:root:Epoch:5, time:2.777 min
INFO:root:Inference time:5.184961
INFO:root:Dev reward:(11658.652541902558, 6866.323809523812, 12399.166666666668), metrics:(84.66933867734622, 73.14629258516301, 15.737367663644724, 94.64518329489933)
INFO:root:Average reward of epoch 5: 12.843155016103493
INFO:root:Epoch:6, time:3.630 min
INFO:root:Inference time:5.160509
INFO:root:Dev reward:(11608.551149504096, 6853.26904761905, 12409.0), metrics:(85.77154308616375, 74.54909819638532, 15.659838811787083, 95.8201594530616)
INFO:root:Average reward of epoch 6: 15.58359262444635
INFO:root:Epoch:7, time:3.013 min
INFO:root:Inference time:5.193378
INFO:root:Dev reward:(11664.660453435468, 6850.769047619052, 12300.666666666666), metrics:(84.66933867734622, 72.44488977955186, 15.555379563906916, 94.11249379235595)
INFO:root:Average reward of epoch 7: 13.812859114180348
INFO:root:Epoch:8, time:2.819 min
INFO:root:Inference time:5.161849
INFO:root:Dev reward:(11624.602701383586, 6830.885714285719, 12310.666666666668), metrics:(85.0701402805526, 71.94388777554389, 15.702433702020304, 94.20944773006855)
INFO:root:Average reward of epoch 8: 13.544821086350842
INFO:root:Epoch:9, time:3.361 min
INFO:root:Inference time:5.077911
INFO:root:Dev reward:(11822.709928959945, 7039.054761904761, 12554.833333333334), metrics:(86.5731462925765, 74.64929859718691, 15.816924418212485, 96.42814686309418)
INFO:root:Average reward of epoch 9: 14.846357894779594
INFO:root:Epoch:10, time:3.568 min
INFO:root:Inference time:5.145032
INFO:root:Dev reward:(11665.987121865064, 6833.973809523805, 12342.333333333332), metrics:(86.07214428856852, 74.54909819638532, 15.395261101119795, 95.70588234359671)
INFO:root:Average reward of epoch 10: 14.937139774076563
INFO:root:Epoch:11, time:2.743 min
INFO:root:Inference time:5.209642
INFO:root:Dev reward:(11770.725507825522, 6953.586507936507, 12456.0), metrics:(86.07214428856852, 74.8496993987901, 15.538565242524275, 95.99948708620357)
INFO:root:Average reward of epoch 11: 12.919002874837842
INFO:root:Epoch:12, time:2.992 min
INFO:root:Inference time:5.195804
INFO:root:Dev reward:(11662.987778561304, 6932.967460317466, 12374.999999999998), metrics:(86.3727454909733, 73.44689378756779, 15.702225277386184, 95.61204491665674)
INFO:root:Average reward of epoch 12: 13.312667482926848
INFO:root:Epoch:13, time:3.178 min
INFO:root:Inference time:5.363790
INFO:root:Dev reward:(11762.057373182377, 7017.324603174608, 12516.333333333334), metrics:(85.87174348696533, 74.24849699398052, 15.709624087667724, 95.76974432814065)
INFO:root:Average reward of epoch 13: 13.650202752718007
INFO:root:Epoch:14, time:3.091 min
INFO:root:Inference time:5.285999
INFO:root:Dev reward:(11635.808354553936, 6940.488095238091, 12419.833333333334), metrics:(85.27054108215579, 74.24849699398052, 15.784094592231368, 95.54361363029953)
INFO:root:Average reward of epoch 14: 13.802790710999577
INFO:root:Epoch:15, time:3.774 min
INFO:root:Inference time:5.259082
INFO:root:Dev reward:(11701.187989787988, 6841.852380952377, 12354.833333333332), metrics:(85.37074148295737, 72.14428857714708, 15.579344149398846, 94.33685917945107)
INFO:root:Average reward of epoch 15: 15.749059922328339
INFO:root:Epoch:16, time:3.407 min
INFO:root:Inference time:5.251773
INFO:root:Dev reward:(11772.057203417515, 7015.5428571428565, 12454.833333333332), metrics:(85.97194388776693, 74.54909819638532, 15.506976003979634, 95.76749704605575)
INFO:root:Average reward of epoch 16: 14.588894454357172
INFO:root:Epoch:17, time:3.616 min
INFO:root:Inference time:4.992745
INFO:root:Dev reward:(11785.758982683989, 7046.230952380952, 12472.0), metrics:(86.3727454909733, 74.94989979959169, 15.532719117096574, 96.19404176237907)
INFO:root:Average reward of epoch 17: 15.73322230989947
INFO:root:Epoch:18, time:2.766 min
INFO:root:Inference time:5.088693
INFO:root:Dev reward:(11699.905849705849, 6889.759523809524, 12341.499999999998), metrics:(86.27254509017172, 74.8496993987901, 15.630620087726484, 96.1917423322074)
INFO:root:Average reward of epoch 18: 13.043380684560022
INFO:root:Epoch:19, time:2.949 min
INFO:root:Inference time:5.102026
INFO:root:Dev reward:(11734.064185814195, 6887.854761904762, 12419.5), metrics:(85.37074148295737, 73.54709418836937, 15.644737390655173, 95.10365522631855)
INFO:root:Average reward of epoch 19: 13.802491020105048
INFO:root:Epoch:20, time:3.303 min
INFO:root:Inference time:5.092306
INFO:root:Dev reward:(11761.212130353306, 6883.746825396826, 12342.833333333332), metrics:(84.66933867734622, 74.04809619237734, 15.550806775166851, 94.90952421002862)
INFO:root:Average reward of epoch 20: 14.072484145628682
INFO:root:Epoch:21, time:3.509 min
INFO:root:Inference time:5.087094
INFO:root:Dev reward:(11563.82095159742, 6925.635714285714, 12325.499999999998), metrics:(85.57114228456057, 74.34869739478212, 15.72500915426518, 95.68492899393652)
INFO:root:Average reward of epoch 21: 15.10670664386333
INFO:root:Epoch:22, time:2.641 min
INFO:root:Inference time:4.949872
INFO:root:Dev reward:(11921.214568764566, 7132.8642857142795, 12616.5), metrics:(88.17635270540198, 76.55310621241718, 15.559043780136472, 97.92377323904606)
INFO:root:Average reward of epoch 22: 12.269064544926827
INFO:root:Epoch:23, time:3.640 min
INFO:root:Inference time:5.016212
INFO:root:Dev reward:(11827.189222542173, 7023.065873015872, 12472.999999999998), metrics:(86.3727454909733, 76.0521042084092, 15.785639860096165, 96.99806470978741)
INFO:root:Average reward of epoch 23: 14.295223235390555
INFO:root:Epoch:24, time:2.737 min
INFO:root:Inference time:4.933586
INFO:root:Dev reward:(11779.686046796343, 6953.884920634919, 12428.833333333332), metrics:(86.17234468937012, 74.14829659317894, 15.557676806165249, 95.71799744743977)
INFO:root:Average reward of epoch 24: 13.176151603235878
INFO:root:Epoch:25, time:3.819 min
INFO:root:Inference time:4.984249
INFO:root:Dev reward:(11728.602985902986, 6946.754761904758, 12493.333333333332), metrics:(86.07214428856852, 73.14629258516301, 15.513723117438957, 95.12294155430473)
INFO:root:Average reward of epoch 25: 16.398100448503182
INFO:root:Epoch:26, time:3.028 min
INFO:root:Inference time:4.945217
INFO:root:Dev reward:(11596.764240334825, 6789.688095238101, 12322.833333333334), metrics:(85.0701402805526, 73.34669338676619, 15.66784641150319, 94.87626324516258)
INFO:root:Average reward of epoch 26: 14.340550419090452
INFO:root:Epoch:27, time:3.002 min
INFO:root:Inference time:4.976340
INFO:root:Dev reward:(11677.365075610665, 6887.140476190477, 12331.166666666668), metrics:(85.17034068135419, 74.04809619237734, 15.589052991374302, 95.19827142824008)
INFO:root:Average reward of epoch 27: 14.789044443831035
INFO:root:Epoch:28, time:3.262 min
INFO:root:Inference time:4.817903
INFO:root:Dev reward:(11740.684973523206, 6923.460317460314, 12423.5), metrics:(86.5731462925765, 74.24849699398052, 15.60870880975805, 96.01953045303657)
INFO:root:Average reward of epoch 28: 14.85720458555503
INFO:root:Epoch:29, time:2.427 min
INFO:root:Inference time:4.786241
INFO:root:Dev reward:(11625.860775009323, 6768.279365079364, 12292.83333333333), metrics:(84.66933867734622, 72.34468937875026, 15.547781831791207, 94.05479585983946)
INFO:root:Average reward of epoch 29: 12.203132026457508
INFO:root:Epoch:30, time:2.911 min
INFO:root:Inference time:4.783653
INFO:root:Dev reward:(11698.295933151816, 6907.328571428576, 12321.166666666666), metrics:(86.17234468937012, 73.74749498997257, 15.666942536011158, 95.6268623756825)
INFO:root:Average reward of epoch 30: 14.638452984076439
INFO:root:Epoch:31, time:2.893 min
INFO:root:Inference time:4.807256
INFO:root:Dev reward:(11797.432134532144, 6968.471428571426, 12487.500000000002), metrics:(86.87374749498127, 75.45090180359965, 15.926589032330273, 97.08891368162074)
INFO:root:Average reward of epoch 31: 13.672651163728354
INFO:root:Epoch:32, time:2.696 min
INFO:root:Inference time:4.773393
INFO:root:Dev reward:(11702.13982667659, 6876.607142857138, 12363.83333333333), metrics:(84.36873747494144, 71.94388777554389, 15.64861098361043, 93.80492360885309)
INFO:root:Average reward of epoch 32: 13.328358290546472
INFO:root:Epoch:33, time:3.055 min
INFO:root:Inference time:4.793668
INFO:root:Dev reward:(11860.298620823622, 7021.515873015873, 12523.333333333332), metrics:(86.4729458917749, 76.0521042084092, 15.61513988708361, 96.87766493717567)
INFO:root:Average reward of epoch 33: 14.746501809424394
INFO:root:Epoch:34, time:2.431 min
INFO:root:Inference time:4.793913
INFO:root:Dev reward:(11750.123391151328, 6977.385714285721, 12460.333333333334), metrics:(84.969939879751, 74.34869739478212, 15.940561201303977, 95.59987983857053)
INFO:root:Average reward of epoch 34: 12.301242011204062
INFO:root:Epoch:35, time:2.818 min
INFO:root:Inference time:4.830690
INFO:root:Dev reward:(11709.575008325004, 7006.967460317463, 12427.166666666668), metrics:(86.97394789578287, 74.44889779558372, 15.414494005607777, 96.12591685129108)
INFO:root:Average reward of epoch 35: 14.477735374976586
INFO:root:Epoch:36, time:2.989 min
INFO:root:Inference time:4.802516
INFO:root:Dev reward:(11717.194009911658, 6939.869047619052, 12421.166666666662), metrics:(86.3727454909733, 74.7494989979885, 15.431595586135725, 95.99271783061663)
INFO:root:Average reward of epoch 36: 15.073042563447842
INFO:root:Epoch:37, time:2.810 min
INFO:root:Inference time:4.810118
INFO:root:Dev reward:(11621.455314293562, 6811.264285714283, 12338.833333333332), metrics:(84.66933867734622, 73.74749498997257, 15.724720510747126, 94.9331373444065)
INFO:root:Average reward of epoch 37: 13.992950886692528
INFO:root:Epoch:38, time:3.616 min
INFO:root:Inference time:4.673363
INFO:root:Dev reward:(11635.86071069453, 6812.251587301588, 12291.499999999996), metrics:(83.6673346693303, 72.44488977955186, 15.554205375137295, 93.61031759957838)
INFO:root:Average reward of epoch 38: 17.115300060425966
INFO:root:Epoch:39, time:2.785 min
INFO:root:Inference time:4.670233
INFO:root:Dev reward:(11686.793573093564, 6873.04523809524, 12348.833333333334), metrics:(85.97194388776693, 72.64529058115504, 15.384941886534904, 94.69355912099589)
INFO:root:Average reward of epoch 39: 14.049602308745529
