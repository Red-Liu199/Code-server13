INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running pretraining *****
INFO:root:  Num Dialogs = 8434
INFO:root:  Num Epochs = 60
INFO:root:  Batch size  = 2
INFO:root:warmup epochs:12
INFO:root:Input examples:
INFO:root:<sos_u>  i need a place to eat that is cheap. <eos_u> <sos_b> [restaurant]  pricerange cheap <eos_b> <sos_db> [db_3] <eos_db> <sos_r>  i have [value_choice] [value_price]  restaurant -s in different area -s of town. do you have a location preference? <eos_r> <sos_u>  yes. i want the center area. <eos_u> <sos_b> [restaurant]  pricerange cheap area centre <eos_b> <sos_db> [db_3] <eos_db> <sos_r>  i can recommend [value_name]  that serves [value_food]  food <eos_r> <sos_u>  do you have any restaurant -s that serve english food? <eos_u> <sos_b> [restaurant]  pricerange cheap area centre food english <eos_b> <sos_db> [db_0] <eos_db> <sos_r>  i am showing nothing for [value_food]  food in the [value_area]  area. would you like to try something else? <eos_r> <sos_u>  how about some awesome indian food. i need a table for 8 on 16:30 monday <eos_u> <sos_b> [restaurant]  pricerange cheap area centre food indian people 8 day monday time 16:30 <eos_b> <sos_db> [db_2] <eos_db> <sos_r>  i booked you at [value_name] . the table will be reserved for 15 minutes. reference number is : [value_reference] . is there anything else i can help you with? <eos_r> <sos_u>  thanks for your help. in addition, i am looking for a thursday train departing cambridge, please. <eos_u> <sos_b> [train]  day thursday departure cambridge [restaurant]  pricerange cheap area centre food indian people 8 day monday time 16:30 <eos_b> <sos_db> [db_3] <eos_db> <sos_r>  there are [value_choice]  trains leaving [value_departure]  on [value_day] . where is your destination? <eos_r> <sos_u>  i am looking to travel to ely departing after 13:15 if possible. <eos_u> <sos_b> [train]  day thursday departure cambridge leave 13:15 destination ely [restaurant]  pricerange cheap area centre food indian people 8 day monday time 16:30 <eos_b> <sos_db> [db_2] <eos_db> <sos_r>  the [value_id]  leaves at [value_leave]  on [value_day] . would you like me to book you? <eos_r> <sos_u>  yes, please book 8 tickets and provide me with a reference number <eos_u> <sos_b> [train]  day thursday departure cambridge leave 13:15 destination ely people 8 [restaurant]  pricerange cheap area centre food indian people 8 day monday time 16:30 <eos_b> <sos_db> [db_2] <eos_db> <sos_r>  okay i have booked that for you and the reference number is [value_reference] . is there anything else i can do for you? <eos_r> <sos_u>  great, thanks. that is all for now! <eos_u> <sos_b> [train]  day thursday departure cambridge leave 13:15 destination ely people 8 [restaurant]  pricerange cheap area centre food indian people 8 day monday time 16:30 <eos_b> <sos_db> [db_nores] <eos_db> <sos_r>  ok. i hope you have a great day! <eos_r>
INFO:root:Input examples:
INFO:root:<sos_u>  i need to find some information in a particular restaurant. are you able to look up a specific place? <eos_u> <sos_b> <eos_b> <sos_db> [db_nores] <eos_db> <sos_r>  absolutely. what is the name of the restaraunt you are interested in? <eos_r> <sos_u>  kohinoor. i want to book a table for 2 people at 16:45 on thursday <eos_u> <sos_b> [restaurant]  name kohinoor people 2 day thursday time 16:45 <eos_b> <sos_db> [db_1] <eos_db> <sos_r>  sure. booking was successful. the table will be reserved for 15 minutes. reference number is : [value_reference] . can i help with anything else today? <eos_r> <sos_u>  i also need a thursday train. <eos_u> <sos_b> [train]  day thursday [restaurant]  name kohinoor people 2 day thursday time 16:45 <eos_b> <sos_db> [db_3] <eos_db> <sos_r>  what location will you depart from and where are you headed? <eos_r> <sos_u>  depart from ely and would like to arrive by 13:00 in cambridge. i need to book it for 2 people i also need a reference number. thanks <eos_u> <sos_b> [train]  day thursday destination cambridge arrive 13:00 departure ely people 2 [restaurant]  name kohinoor people 2 day thursday time 16:45 <eos_b> <sos_db> [db_1] <eos_db> <sos_r>  sure thing, it is booked and your reference number is [value_reference] . do you need more help? <eos_r> <sos_u>  nope, i am all finished for today. thanks so much, goodbye now! <eos_u> <sos_b> [train]  day thursday destination cambridge arrive 13:00 departure ely people 2 [restaurant]  name kohinoor people 2 day thursday time 16:45 <eos_b> <sos_db> [db_nores] <eos_db> <sos_r>  you are very welcome, bye! <eos_r>
INFO:root:Epoch:0, Train epoch time: 8.40 min, loss: 13.912779230781794
INFO:root:Epoch:1, Train epoch time: 8.38 min, loss: 2.8470962952820678
INFO:root:Epoch:2, Train epoch time: 8.37 min, loss: 1.8213814426554737
INFO:root:Epoch:3, Train epoch time: 8.36 min, loss: 1.358496212045559
INFO:root:Epoch:4, Train epoch time: 8.37 min, loss: 1.1122120481053404
INFO:root:Epoch:5, Train epoch time: 8.39 min, loss: 0.9647758260376373
INFO:root:Epoch:6, Train epoch time: 8.36 min, loss: 0.8771670917071152
INFO:root:Epoch:7, Train epoch time: 8.35 min, loss: 0.8148813848606942
INFO:root:Inference time:5.525 min
INFO:root:validation [CTR] 68.04  51.10  12.90  72.47  0.000
INFO:root:validation 59.92  45.29  12.90  65.51  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:8, Train epoch time: 8.46 min, loss: 0.7697194040486414
INFO:root:Inference time:5.637 min
INFO:root:validation [CTR] 63.53  49.90  13.77  70.48  0.000
INFO:root:validation 51.60  40.28  13.77  59.71  0.000
INFO:root:Epoch:9, Train epoch time: 8.38 min, loss: 0.7355645425479787
INFO:root:Inference time:6.172 min
INFO:root:validation [CTR] 73.45  64.03  14.36  83.10  0.000
INFO:root:validation 57.31  49.40  14.36  67.72  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:10, Train epoch time: 8.38 min, loss: 0.707215011982653
INFO:root:Inference time:5.902 min
INFO:root:validation [CTR] 82.57  65.03  15.15  88.95  0.000
INFO:root:validation 63.23  49.30  15.15  71.41  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:11, Train epoch time: 8.42 min, loss: 0.6842232546395581
INFO:root:Inference time:5.364 min
INFO:root:validation [CTR] 79.66  60.72  14.75  84.94  0.000
INFO:root:validation 68.74  52.10  14.75  75.17  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:12, Train epoch time: 8.36 min, loss: 0.6623923434329134
INFO:root:Inference time:5.196 min
INFO:root:validation [CTR] 88.08  69.94  14.97  93.98  0.000
INFO:root:validation 81.56  65.03  14.97  88.27  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:13, Train epoch time: 8.34 min, loss: 0.6425980476014524
INFO:root:Inference time:5.396 min
INFO:root:validation [CTR] 93.29  74.85  15.90  99.97  0.000
INFO:root:validation 80.56  64.03  15.90  88.20  0.000
INFO:root:early stop count:4
INFO:root:Epoch:14, Train epoch time: 8.37 min, loss: 0.6257609358445467
INFO:root:Inference time:5.309 min
INFO:root:validation [CTR] 86.17  63.13  13.74  88.38  0.000
INFO:root:validation 77.86  57.11  13.74  81.22  0.000
INFO:root:early stop count:3
INFO:root:Epoch:15, Train epoch time: 8.37 min, loss: 0.6099311180897217
INFO:root:Inference time:5.236 min
INFO:root:validation [CTR] 85.47  58.62  14.04  86.08  0.000
INFO:root:validation 80.76  54.61  14.04  81.73  0.000
INFO:root:early stop count:2
INFO:root:Epoch:16, Train epoch time: 8.37 min, loss: 0.5961838313115395
INFO:root:Inference time:5.435 min
INFO:root:validation [CTR] 84.87  71.94  15.75  94.16  0.000
INFO:root:validation 76.75  64.73  15.75  86.50  0.000
INFO:root:early stop count:1
INFO:root:Epoch:17, Train epoch time: 8.37 min, loss: 0.5834963471510708
INFO:root:Inference time:5.318 min
INFO:root:validation [CTR] 84.67  62.42  14.76  88.30  0.000
INFO:root:validation 78.56  57.72  14.76  82.89  0.000
INFO:root:early stop count:0
INFO:root:Epoch:18, Train epoch time: 8.39 min, loss: 0.5706273961120949
INFO:root:Inference time:5.274 min
INFO:root:validation [CTR] 86.57  66.33  14.56  91.02  0.000
INFO:root:validation 81.26  62.73  14.56  86.56  0.000
INFO:root:early stop count:-1
INFO:root:Epoch:19, Train epoch time: 8.38 min, loss: 0.5600591095727544
INFO:root:Inference time:5.391 min
INFO:root:validation [CTR] 81.36  60.52  14.62  85.56  0.000
INFO:root:validation 77.56  57.62  14.62  82.20  0.000
INFO:root:early stop count:-2
INFO:root:Epoch:20, Train epoch time: 8.39 min, loss: 0.5494292040338266
INFO:root:Inference time:5.249 min
INFO:root:validation [CTR] 88.18  73.95  15.16  96.22  0.000
INFO:root:validation 82.97  69.74  15.16  91.51  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:21, Train epoch time: 8.36 min, loss: 0.5390536116978032
INFO:root:Inference time:5.309 min
INFO:root:validation [CTR] 89.08  74.85  16.08  98.05  0.000
INFO:root:validation 84.57  71.54  16.08  94.14  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:22, Train epoch time: 8.35 min, loss: 0.529538942245465
INFO:root:Inference time:5.425 min
INFO:root:validation [CTR] 89.18  60.72  14.47  89.42  0.000
INFO:root:validation 86.37  58.72  14.47  87.02  0.000
INFO:root:early stop count:4
INFO:root:Epoch:23, Train epoch time: 8.35 min, loss: 0.520823827719711
INFO:root:Inference time:5.330 min
INFO:root:validation [CTR] 89.48  72.04  15.66  96.42  0.000
INFO:root:validation 85.47  69.04  15.66  92.92  0.000
INFO:root:early stop count:3
INFO:root:Epoch:24, Train epoch time: 8.39 min, loss: 0.5118958776066187
INFO:root:Inference time:5.499 min
INFO:root:validation [CTR] 88.08  68.54  15.43  93.73  0.000
INFO:root:validation 85.57  66.93  15.43  91.68  0.000
INFO:root:early stop count:2
INFO:root:Epoch:25, Train epoch time: 8.83 min, loss: 0.5039153136083114
INFO:root:Inference time:5.330 min
INFO:root:validation [CTR] 89.28  67.94  15.62  94.23  0.000
INFO:root:validation 86.67  66.13  15.62  92.02  0.000
INFO:root:early stop count:1
INFO:root:Epoch:26, Train epoch time: 8.56 min, loss: 0.4961317190515893
INFO:root:Inference time:5.810 min
INFO:root:validation [CTR] 89.38  68.94  15.55  94.71  0.000
INFO:root:validation 86.27  66.43  15.55  91.90  0.000
INFO:root:early stop count:0
INFO:root:Epoch:27, Train epoch time: 8.49 min, loss: 0.48713937414678343
INFO:root:Inference time:5.300 min
INFO:root:validation [CTR] 88.38  76.65  15.64  98.15  0.000
INFO:root:validation 86.67  75.55  15.64  96.75  0.000
INFO:root:Saving model checkpoint to ./experiments_21/all_full_sd11_lr0.0001_bs2_ga16/best_score_model
INFO:root:Epoch:28, Train epoch time: 8.42 min, loss: 0.4806693038515531
INFO:root:Inference time:5.321 min
INFO:root:validation [CTR] 87.88  69.94  14.99  93.90  0.000
INFO:root:validation 85.37  67.94  14.99  91.64  0.000
INFO:root:early stop count:4
INFO:root:Epoch:29, Train epoch time: 8.38 min, loss: 0.47333028545319383
INFO:root:Inference time:5.423 min
INFO:root:validation [CTR] 89.28  66.03  14.96  92.61  0.000
INFO:root:validation 86.77  64.43  14.96  90.56  0.000
INFO:root:early stop count:3
INFO:root:Epoch:30, Train epoch time: 8.37 min, loss: 0.46658488625760436
INFO:root:Inference time:5.334 min
INFO:root:validation [CTR] 89.68  72.34  15.40  96.41  0.000
INFO:root:validation 87.17  70.14  15.40  94.05  0.000
INFO:root:early stop count:2
INFO:root:Epoch:31, Train epoch time: 8.36 min, loss: 0.4601268719229361
INFO:root:Inference time:5.491 min
INFO:root:validation [CTR] 87.47  64.33  15.05  90.95  0.000
INFO:root:validation 85.17  62.93  15.05  89.10  0.000
INFO:root:early stop count:1
INFO:root:Epoch:32, Train epoch time: 8.36 min, loss: 0.4538864226340823
INFO:root:Inference time:5.432 min
INFO:root:validation [CTR] 88.18  73.65  15.97  96.88  0.000
INFO:root:validation 84.97  71.04  15.97  93.98  0.000
INFO:root:early stop count:0
INFO:root:Epoch:33, Train epoch time: 8.37 min, loss: 0.44776093228541114
INFO:root:Inference time:5.367 min
INFO:root:validation [CTR] 89.18  72.24  15.13  95.84  0.000
INFO:root:validation 87.37  70.64  15.13  94.14  0.000
INFO:root:early stop count:-1
INFO:root:Epoch:34, Train epoch time: 8.37 min, loss: 0.4418139034456971
INFO:root:Inference time:5.485 min
INFO:root:validation [CTR] 91.78  73.85  15.85  98.66  0.000
INFO:root:validation 86.27  69.54  15.85  93.76  0.000
INFO:root:early stop count:-2
INFO:root:Epoch:35, Train epoch time: 8.37 min, loss: 0.4364715007986426
INFO:root:Inference time:5.350 min
INFO:root:validation [CTR] 89.08  71.64  15.24  95.60  0.000
INFO:root:validation 86.77  70.04  15.24  93.65  0.000
INFO:root:early stop count:-3
INFO:root:Epoch:36, Train epoch time: 8.38 min, loss: 0.43145375858548557
INFO:root:Inference time:5.421 min
INFO:root:validation [CTR] 90.38  74.15  15.72  97.99  0.000
INFO:root:validation 87.78  72.44  15.72  95.83  0.000
INFO:root:early stop count:-4
INFO:root:Epoch:37, Train epoch time: 8.39 min, loss: 0.42612882841274136
INFO:root:Inference time:5.487 min
INFO:root:validation [CTR] 90.08  67.54  14.81  93.62  0.000
INFO:root:validation 88.68  66.33  14.81  92.32  0.000
INFO:root:early stop count:-5
INFO:root:Epoch:38, Train epoch time: 8.39 min, loss: 0.42147119188222437
INFO:root:Inference time:5.385 min
INFO:root:validation [CTR] 90.18  72.24  15.02  96.24  0.000
INFO:root:validation 86.57  69.54  15.02  93.08  0.000
INFO:root:early stop count:-6
INFO:root:Epoch:39, Train epoch time: 8.36 min, loss: 0.41683112079207796
INFO:root:Inference time:5.500 min
INFO:root:validation [CTR] 89.68  73.35  16.02  97.54  0.000
INFO:root:validation 86.87  71.04  16.02  94.98  0.000
INFO:root:early stop count:-7
INFO:root:Epoch:40, Train epoch time: 8.38 min, loss: 0.4122479767867907
INFO:root:Inference time:5.392 min
INFO:root:validation [CTR] 88.38  69.24  14.86  93.67  0.000
INFO:root:validation 86.17  67.43  14.86  91.66  0.000
INFO:root:early stop count:-8
INFO:root:Epoch:41, Train epoch time: 8.34 min, loss: 0.40809327525700656
INFO:root:Inference time:5.417 min
INFO:root:validation [CTR] 91.18  71.24  15.38  96.60  0.000
INFO:root:validation 89.38  69.44  15.38  94.79  0.000
INFO:root:early stop count:-9
INFO:root:Epoch:42, Train epoch time: 8.36 min, loss: 0.40348445076104666
INFO:root:Inference time:5.424 min
INFO:root:validation [CTR] 89.58  68.64  14.89  94.00  0.000
INFO:root:validation 86.27  65.73  14.89  90.89  0.000
INFO:root:early stop count:-10
INFO:root:Epoch:43, Train epoch time: 8.35 min, loss: 0.400245477197896
INFO:root:Inference time:5.398 min
INFO:root:validation [CTR] 92.18  73.55  15.19  98.06  0.000
INFO:root:validation 88.48  70.84  15.19  94.85  0.000
INFO:root:early stop count:-11
INFO:root:Epoch:44, Train epoch time: 8.35 min, loss: 0.3961343998365691
INFO:root:Inference time:5.408 min
INFO:root:validation [CTR] 89.78  65.83  14.58  92.39  0.000
INFO:root:validation 86.97  63.83  14.58  89.98  0.000
INFO:root:early stop count:-12
INFO:root:Epoch:45, Train epoch time: 8.38 min, loss: 0.39226868621276545
INFO:root:Inference time:5.445 min
INFO:root:validation [CTR] 90.08  71.64  15.31  96.17  0.000
INFO:root:validation 86.77  68.94  15.31  93.17  0.000
INFO:root:early stop count:-13
INFO:root:Epoch:46, Train epoch time: 8.36 min, loss: 0.3893610337686358
INFO:root:Inference time:5.496 min
INFO:root:validation [CTR] 90.28  70.54  14.66  95.07  0.000
INFO:root:validation 87.88  68.64  14.66  92.91  0.000
INFO:root:early stop count:-14
INFO:root:Epoch:47, Train epoch time: 8.39 min, loss: 0.38598948919095405
INFO:root:Inference time:5.440 min
INFO:root:validation [CTR] 89.38  74.55  15.25  97.21  0.000
INFO:root:validation 86.77  72.14  15.25  94.71  0.000
INFO:root:early stop count:-15
INFO:root:Epoch:48, Train epoch time: 8.36 min, loss: 0.3831270858243207
INFO:root:Inference time:5.430 min
INFO:root:validation [CTR] 92.08  73.55  14.84  97.65  0.000
INFO:root:validation 88.68  70.84  14.84  94.60  0.000
INFO:root:early stop count:-16
INFO:root:Epoch:49, Train epoch time: 8.37 min, loss: 0.38037885604386484
INFO:root:Inference time:5.414 min
INFO:root:validation [CTR] 90.18  70.94  15.12  95.68  0.000
INFO:root:validation 87.58  69.04  15.12  93.43  0.000
INFO:root:early stop count:-17
INFO:root:Epoch:50, Train epoch time: 8.36 min, loss: 0.37794347291332275
INFO:root:Inference time:5.416 min
INFO:root:validation [CTR] 89.88  70.84  15.04  95.40  0.000
INFO:root:validation 86.87  68.24  15.04  92.59  0.000
INFO:root:early stop count:-18
INFO:root:Epoch:51, Train epoch time: 8.38 min, loss: 0.3756179134549302
INFO:root:Inference time:5.390 min
INFO:root:validation [CTR] 88.68  71.34  15.08  95.09  0.000
INFO:root:validation 86.27  69.24  15.08  92.83  0.000
INFO:root:early stop count:-19
INFO:root:Epoch:52, Train epoch time: 8.40 min, loss: 0.3734448305094693
INFO:root:Inference time:5.365 min
INFO:root:validation [CTR] 90.68  72.85  15.06  96.83  0.000
INFO:root:validation 87.88  71.04  15.06  94.52  0.000
INFO:root:early stop count:-20
INFO:root:Epoch:53, Train epoch time: 8.42 min, loss: 0.3710988074095542
INFO:root:Inference time:5.372 min
INFO:root:validation [CTR] 90.48  70.44  14.82  95.28  0.000
INFO:root:validation 87.37  67.74  14.82  92.37  0.000
INFO:root:early stop count:-21
INFO:root:Epoch:54, Train epoch time: 8.37 min, loss: 0.3693634203847765
INFO:root:Inference time:5.384 min
INFO:root:validation [CTR] 88.98  73.15  15.11  96.17  0.000
INFO:root:validation 86.07  71.04  15.11  93.67  0.000
INFO:root:early stop count:-22
INFO:root:Epoch:55, Train epoch time: 8.46 min, loss: 0.3674898786319125
INFO:root:Inference time:5.410 min
INFO:root:validation [CTR] 89.28  70.94  15.12  95.23  0.000
INFO:root:validation 87.07  68.74  15.12  93.03  0.000
INFO:root:early stop count:-23
INFO:root:Epoch:56, Train epoch time: 8.40 min, loss: 0.3659401686603975
INFO:root:Inference time:5.358 min
INFO:root:validation [CTR] 88.78  69.74  14.83  94.09  0.000
INFO:root:validation 86.17  67.64  14.83  91.73  0.000
INFO:root:early stop count:-24
INFO:root:Epoch:57, Train epoch time: 8.36 min, loss: 0.364883907618886
INFO:root:Inference time:6.047 min
INFO:root:validation [CTR] 87.98  70.44  14.99  94.20  0.000
INFO:root:validation 85.87  68.94  14.99  92.40  0.000
INFO:root:early stop count:-25
INFO:root:Epoch:58, Train epoch time: 9.96 min, loss: 0.3637277434286531
INFO:root:Inference time:6.957 min
INFO:root:validation [CTR] 89.18  71.24  15.16  95.37  0.000
INFO:root:validation 86.17  68.54  15.16  92.52  0.000
INFO:root:early stop count:-26
INFO:root:Epoch:59, Train epoch time: 9.06 min, loss: 0.36268882595305874
INFO:root:Inference time:5.383 min
INFO:root:validation [CTR] 89.08  71.54  14.98  95.29  0.000
INFO:root:validation 86.17  68.94  14.98  92.53  0.000
INFO:root:early stop count:-27
