INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 14195
INFO:root:  Num Turns = 56565
INFO:root:  Num Dialogs = 8421
INFO:root:  Num Epochs = 40
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 70975
INFO:root:Input examples:
INFO:root:<sos_u>  i need a train for sunday please. i prefer 1 that arrives by 20:15 <eos_u> <sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  choice [request]  destination <eos_a> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r> <sos_u>  i am heading to birmingham new street. <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, that would be fine. i 'll need the price, trainid, and departure time, please? <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  price leave departure <eos_a> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r> <sos_u>  i would also like to find a nice concerthall in the middle of town. <eos_u> <sos_b> [attraction]  type concert hall area centre [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  the [value_type]  in the [value_area]  is [value_name]  located at [value_address] . <eos_r>
INFO:root:hotel database path:db/hotel_db_processed.json
INFO:root:Added special tokens to gpt tokenizer.
INFO:root:Reading encoded data from ./data/multi-woz-2.1-processed/new_db_se_blank_encoded.data.json
INFO:root:train size:8434, dev size:999, test size:1000
INFO:root:[50314, 50315, 50313, 50308, 50309, 50307]
INFO:root:Prior model loaded from ../distilgpt2
INFO:root:***** Running turn-level training *****
INFO:root:  Num Training steps(one turn in a batch of dialogs) per epoch = 14195
INFO:root:  Num Turns = 56565
INFO:root:  Num Dialogs = 8421
INFO:root:  Num Epochs = 40
INFO:root:  Batch size  = 4
INFO:root:  Gradient Accumulation steps = 8
INFO:root:  Total optimization steps = 70975
INFO:root:Input examples:
INFO:root:<sos_u>  i need a train for sunday please. i prefer 1 that arrives by 20:15 <eos_u> <sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_db> [db_3] <eos_db> <sos_a> [train] [inform]  choice [request]  destination <eos_a> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 <eos_b> <sos_r>  we have [value_choice]  those! where is your destination? <eos_r> <sos_u>  i am heading to birmingham new street. <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  arrive id [select] <eos_a> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r> [value_id]  arrives by [value_arrive] . does that work for you? <eos_r> <sos_u>  yes, that would be fine. i 'll need the price, trainid, and departure time, please? <eos_u> <sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [train] [inform]  price leave departure <eos_a> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r>
INFO:root:Input examples:
INFO:root:<sos_b> [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_r>  the train will depart [value_departure]  at [value_leave]  and the price is [value_price] . <eos_r> <sos_u>  i would also like to find a nice concerthall in the middle of town. <eos_u> <sos_b> [attraction]  type concert hall area centre [train]  day sunday arrive 20:15 destination birmingham new street <eos_b> <sos_db> [db_1] <eos_db> <sos_a> [attraction] [inform]  address type area name <eos_a> <sos_r>  the [value_type]  in the [value_area]  is [value_name]  located at [value_address] . <eos_r>
INFO:root:Epoch:0, Train epoch time: 13.27 min, epoch loss: 84493.7199
INFO:root:Epoch:1, Train epoch time: 14.09 min, epoch loss: 18916.1063
INFO:root:Epoch:2, Train epoch time: 13.96 min, epoch loss: 12663.1533
INFO:root:Epoch:3, Train epoch time: 13.90 min, epoch loss: 10562.6000
INFO:root:Inference time:3.633 min
INFO:root:validation [CTR] 57.41  43.99  14.56  65.26  0.363
INFO:root:validation 54.01  41.48  14.56  62.30  0.363
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:4, Train epoch time: 13.70 min, epoch loss: 9507.7472
INFO:root:Inference time:3.532 min
INFO:root:validation [CTR] 74.65  62.02  15.50  83.84  0.399
INFO:root:validation 69.84  57.82  15.50  79.33  0.399
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:5, Train epoch time: 13.74 min, epoch loss: 8884.8388
INFO:root:Inference time:3.588 min
INFO:root:validation [CTR] 71.94  63.43  16.10  83.78  0.407
INFO:root:validation 69.34  60.72  16.10  81.13  0.407
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:6, Train epoch time: 13.67 min, epoch loss: 8432.3334
INFO:root:Inference time:3.628 min
INFO:root:validation [CTR] 72.65  65.13  16.90  85.79  0.433
INFO:root:validation 70.44  63.13  16.90  83.68  0.433
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:7, Train epoch time: 13.78 min, epoch loss: 8084.5230
INFO:root:Inference time:3.393 min
INFO:root:validation [CTR] 83.17  73.45  15.06  93.37  0.423
INFO:root:validation 78.16  69.24  15.06  88.76  0.423
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:8, Train epoch time: 13.09 min, epoch loss: 7744.5231
INFO:root:Inference time:3.624 min
INFO:root:validation [CTR] 74.05  66.63  17.37  87.71  0.452
INFO:root:validation 70.74  64.03  17.37  84.76  0.452
INFO:root:early stop count:4
INFO:root:Epoch:9, Train epoch time: 13.08 min, epoch loss: 7418.8908
INFO:root:Inference time:3.521 min
INFO:root:validation [CTR] 78.06  69.24  16.03  89.67  0.476
INFO:root:validation 76.35  67.84  16.03  88.12  0.476
INFO:root:early stop count:3
INFO:root:Epoch:10, Train epoch time: 13.42 min, epoch loss: 7136.7309
INFO:root:Inference time:3.703 min
INFO:root:validation [CTR] 71.04  64.63  17.50  85.34  0.470
INFO:root:validation 69.74  63.33  17.50  84.04  0.470
INFO:root:early stop count:2
INFO:root:Epoch:11, Train epoch time: 13.10 min, epoch loss: 6886.8228
INFO:root:Inference time:3.726 min
INFO:root:validation [CTR] 85.47  78.16  16.65  98.46  0.481
INFO:root:validation 81.66  74.35  16.65  94.66  0.481
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:12, Train epoch time: 13.11 min, epoch loss: 6659.8489
INFO:root:Inference time:3.739 min
INFO:root:validation [CTR] 88.58  81.16  16.90  101.77  0.473
INFO:root:validation 85.77  78.56  16.90  99.07  0.473
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:13, Train epoch time: 13.78 min, epoch loss: 6449.0076
INFO:root:Inference time:3.737 min
INFO:root:validation [CTR] 84.37  76.45  17.37  97.78  0.470
INFO:root:validation 82.77  74.85  17.37  96.18  0.470
INFO:root:early stop count:4
INFO:root:Epoch:14, Train epoch time: 13.09 min, epoch loss: 6237.7766
INFO:root:Inference time:3.763 min
INFO:root:validation [CTR] 87.27  80.26  17.52  101.29  0.474
INFO:root:validation 84.67  77.76  17.52  98.73  0.474
INFO:root:early stop count:3
INFO:root:Epoch:15, Train epoch time: 13.10 min, epoch loss: 6050.0495
INFO:root:Inference time:3.630 min
INFO:root:validation [CTR] 89.58  80.96  17.03  102.30  0.485
INFO:root:validation 87.47  78.96  17.03  100.25  0.485
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:16, Train epoch time: 13.78 min, epoch loss: 5871.6987
INFO:root:Inference time:3.709 min
INFO:root:validation [CTR] 85.27  78.76  17.28  99.29  0.473
INFO:root:validation 83.37  76.65  17.28  97.29  0.473
INFO:root:early stop count:4
INFO:root:Epoch:17, Train epoch time: 13.25 min, epoch loss: 5695.5931
INFO:root:Inference time:3.822 min
INFO:root:validation [CTR] 88.28  81.96  16.77  101.89  0.454
INFO:root:validation 85.47  79.26  16.77  99.13  0.454
INFO:root:early stop count:3
INFO:root:Epoch:18, Train epoch time: 13.15 min, epoch loss: 5533.9016
INFO:root:Inference time:3.752 min
INFO:root:validation [CTR] 90.58  82.06  16.69  103.01  0.480
INFO:root:validation 88.58  80.26  16.69  101.11  0.480
INFO:root:Saving model checkpoint to ./experiments_21/all_BRU_fix_sd11_lr0.0001_bs4_ga8/best_score_model
INFO:root:Epoch:19, Train epoch time: 13.44 min, epoch loss: 5371.4181
INFO:root:Inference time:3.801 min
INFO:root:validation [CTR] 88.38  80.16  16.67  100.94  0.475
INFO:root:validation 86.07  78.06  16.67  98.73  0.475
INFO:root:early stop count:4
INFO:root:Epoch:20, Train epoch time: 13.16 min, epoch loss: 5219.9344
INFO:root:Inference time:3.722 min
INFO:root:validation [CTR] 90.68  82.36  16.60  103.13  0.484
INFO:root:validation 88.38  80.46  16.60  101.02  0.484
INFO:root:early stop count:3
INFO:root:Epoch:21, Train epoch time: 13.16 min, epoch loss: 5078.5996
INFO:root:Inference time:3.778 min
INFO:root:validation [CTR] 89.58  81.86  16.53  102.25  0.476
INFO:root:validation 87.17  79.56  16.53  99.89  0.476
INFO:root:early stop count:2
INFO:root:Epoch:22, Train epoch time: 13.70 min, epoch loss: 4933.3524
INFO:root:Inference time:3.730 min
INFO:root:validation [CTR] 85.67  78.06  16.15  98.01  0.483
INFO:root:validation 83.17  76.05  16.15  95.76  0.483
INFO:root:early stop count:1
INFO:root:Epoch:23, Train epoch time: 13.17 min, epoch loss: 4801.5837
INFO:root:Inference time:3.785 min
INFO:root:validation [CTR] 89.58  81.66  16.73  102.35  0.477
INFO:root:validation 88.18  80.16  16.73  100.90  0.477
INFO:root:early stop count:0
INFO:root:Epoch:24, Train epoch time: 13.17 min, epoch loss: 4677.5017
INFO:root:Inference time:3.727 min
INFO:root:validation [CTR] 85.97  77.86  16.00  97.92  0.475
INFO:root:validation 85.07  77.15  16.00  97.11  0.475
INFO:root:early stop count:-1
INFO:root:Epoch:25, Train epoch time: 13.68 min, epoch loss: 4559.8523
INFO:root:Inference time:3.711 min
INFO:root:validation [CTR] 88.38  80.86  16.21  100.83  0.473
INFO:root:validation 87.27  79.66  16.21  99.68  0.473
INFO:root:early stop count:-2
INFO:root:Epoch:26, Train epoch time: 13.17 min, epoch loss: 4443.5011
INFO:root:Inference time:3.761 min
INFO:root:validation [CTR] 86.57  78.26  16.02  98.43  0.470
INFO:root:validation 84.57  76.85  16.02  96.73  0.470
INFO:root:early stop count:-3
INFO:root:Epoch:27, Train epoch time: 13.36 min, epoch loss: 4334.9433
INFO:root:Inference time:3.712 min
INFO:root:validation [CTR] 88.08  78.76  15.89  99.31  0.477
INFO:root:validation 87.07  78.06  15.89  98.45  0.477
INFO:root:early stop count:-4
INFO:root:Epoch:28, Train epoch time: 13.64 min, epoch loss: 4226.0880
INFO:root:Inference time:3.651 min
INFO:root:validation [CTR] 89.98  83.47  15.89  102.61  0.472
INFO:root:validation 88.08  81.36  15.89  100.61  0.472
INFO:root:early stop count:-5
INFO:root:Epoch:29, Train epoch time: 13.55 min, epoch loss: 4132.9770
INFO:root:Inference time:3.753 min
INFO:root:validation [CTR] 91.48  83.27  16.02  103.40  0.462
INFO:root:validation 89.08  80.86  16.02  100.99  0.462
INFO:root:early stop count:-6
INFO:root:Epoch:30, Train epoch time: 13.87 min, epoch loss: 4042.2079
INFO:root:Inference time:3.786 min
INFO:root:validation [CTR] 88.88  79.96  15.69  100.11  0.469
INFO:root:validation 87.78  79.06  15.69  99.11  0.469
INFO:root:early stop count:-7
INFO:root:Epoch:31, Train epoch time: 13.19 min, epoch loss: 3959.1286
INFO:root:Inference time:3.820 min
INFO:root:validation [CTR] 88.98  81.66  15.89  101.21  0.478
INFO:root:validation 87.07  79.66  15.89  99.26  0.478
INFO:root:early stop count:-8
INFO:root:Epoch:32, Train epoch time: 13.19 min, epoch loss: 3877.8250
INFO:root:Inference time:3.814 min
INFO:root:validation [CTR] 90.68  81.46  15.95  102.02  0.463
INFO:root:validation 88.38  79.06  15.95  99.66  0.463
INFO:root:early stop count:-9
INFO:root:Epoch:33, Train epoch time: 13.19 min, epoch loss: 3804.6429
INFO:root:Inference time:3.795 min
INFO:root:validation [CTR] 90.28  81.36  15.64  101.47  0.483
INFO:root:validation 88.58  79.66  15.64  99.76  0.483
INFO:root:early stop count:-10
INFO:root:Epoch:34, Train epoch time: 13.47 min, epoch loss: 3737.1174
INFO:root:Inference time:3.779 min
INFO:root:validation [CTR] 89.98  81.86  16.13  102.05  0.468
INFO:root:validation 87.37  79.36  16.13  99.50  0.468
INFO:root:early stop count:-11
INFO:root:Epoch:35, Train epoch time: 13.22 min, epoch loss: 3669.8788
INFO:root:Inference time:3.706 min
INFO:root:validation [CTR] 90.48  82.06  15.76  102.04  0.474
INFO:root:validation 88.08  79.66  15.76  99.63  0.474
INFO:root:early stop count:-12
INFO:root:Epoch:36, Train epoch time: 13.92 min, epoch loss: 3617.9295
INFO:root:Inference time:3.769 min
INFO:root:validation [CTR] 90.28  82.67  15.79  102.27  0.467
INFO:root:validation 88.38  80.56  15.79  100.26  0.467
INFO:root:early stop count:-13
INFO:root:Epoch:37, Train epoch time: 13.20 min, epoch loss: 3573.6430
INFO:root:Inference time:3.787 min
INFO:root:validation [CTR] 89.28  81.36  15.53  100.85  0.467
INFO:root:validation 87.07  78.96  15.53  98.55  0.467
INFO:root:early stop count:-14
INFO:root:Epoch:38, Train epoch time: 13.20 min, epoch loss: 3535.2793
INFO:root:Inference time:3.768 min
INFO:root:validation [CTR] 89.78  81.16  15.30  100.77  0.467
INFO:root:validation 87.78  78.96  15.30  98.66  0.467
INFO:root:early stop count:-15
INFO:root:Epoch:39, Train epoch time: 13.54 min, epoch loss: 3506.6959
INFO:root:Inference time:3.771 min
INFO:root:validation [CTR] 89.98  81.46  15.58  101.30  0.463
INFO:root:validation 87.98  79.36  15.58  99.25  0.463
INFO:root:early stop count:-16
